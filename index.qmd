---
title: wsl
authors:
  - name: Norah Jones
    affiliation: The University
    roles: writing
    corresponding: true
bibliography: references.bib
---

# ç›´æ¥å®æˆ˜å§

## ğŸ—‚ï¸ Step 1: Create Your Project Directory

``` bash
mkdir -p ~/bioinformatics_practice/{fastq_raw,fastq_subset,reference}
cd ~/bioinformatics_practice
```

This creates:

-   `fastq_raw`: for full FASTQ files

-   `fastq_subset`: for trimmed/sampled FASTQ files

-   `reference`: for your reference genome

## ğŸ§¬ Step 2: Get Raw Data from GEO

Letâ€™s use **GSE134608** as an example. It links to **SRA accession SRR9693121**.

### ğŸ”§ Install SRA Toolkit (if not done yet)

``` bash
sudo apt update sudo apt install sra-toolkit vdb-config --interactive  # Accept defaults 
```

### ğŸ“¥ Download FASTQ from SRA

``` bash
cd fastq_raw 
fasterq-dump SRR9693121 --split-files --skip-technical --threads 4 
```

This will give you:

-   `SRR9693121_1.fastq`

-   `SRR9693121_2.fastq` (paired-end reads)

-   . **Add Progress Feedback**

    Try running with a progress bar:

    ``` bash
    fasterq-dump SRR9693121 --split-files --skip-technical --threads 4 -p 
    ```

    The `-p` flag shows progress so you know itâ€™s working.

And we get this after the installed

``` bash
jayz@localhost:~/bioinformatics_practice/fastq_raw$ fasterq-dump SRR9693121 --split-files --skip-technical --threads 4 -p-p

join   :|-------------------------------------------------- 100%
concat :|-------------------------------------------------- 100%
spots read      : 23,802,308
reads read      : 47,604,616
reads written   : 23,802,308
reads 0-length  : 23,802,308
jayz@localhost:~/bioinformatics_practice/fastq_raw$
jayz@localhost:~/bioinformatics_practice/fastq_raw$
```

### ğŸ§¬ What Just Happened

-   **Total spots read**: `23,802,308` â€” each spot is a sequencing fragment.

-   **Total reads read**: `47,604,616` â€” paired-end reads (2 per spot).

-   **Reads written**: `23,802,308` â€” only one read per spot was written.

-   **Reads 0-length**: `23,802,308` â€” this suggests that one of the paired reads had zero-length sequences (possibly technical reads that were skipped).

This likely means that only one of the paired files (`_1.fastq` or `_2.fastq`) was successfully written, and the other was skipped due to being empty or technical.

and we check with `ls -lh`

``` bash
jayz@localhost:~/bioinformatics_practice/fastq_raw$ ls -lh
total 4.1G
-rw-r--r-- 1 jayz jayz 4.1G Sep 18 16:17 SRR9693121_1.fastq
drwxr-xr-x 2 jayz jayz 4.0K Sep 18 16:06 fasterq.tmp.localhost.1507
```

weâ€™ve successfully downloaded the raw FASTQ file `SRR9693121_1.fastq`, and itâ€™s a hefty one at **4.1 GB**. Thatâ€™s a full dataset from a human RNA-seq experiment, and itâ€™s ready for action.

## âœ‚ï¸ Step 3: Subset the FASTQ File

Install `seqtk` if needed:

``` bash
sudo apt install seqtk 
```

Then sample 100,000 reads:

``` bash
mkdir -p ~/bioinformatics_practice/fastq_subset
seqtk sample -s100 SRR9693121_1.fastq 100000 > ~/bioinformatics_practice/fastq_subset/SRR9693121_1_subset.fastq
```

-   `-s100`: sets a random seed for reproducibility

-   `100000`: number of reads to keep

You can verify the result:

``` bash
grep -c "^@" ~/bioinformatics_practice/fastq_subset/SRR9693121_1_subset.fastq 
```

and look what we have get

```         
jayz@localhost:~/bioinformatics_practice/fastq_raw$ grep -c "^@" ~/bioinformatics_practice/fastq_subset/SRR9693121_1_subset.fastq
100000
```

### ğŸ§¬ Step 2: Download the Reference Genome

Since this is human RNA-seq, letâ€™s grab **chromosome 1 from GRCh38**:

``` bash
mkdir -p ~/bioinformatics_practice/reference 
cd ~/bioinformatics_practice/reference wget https://hgdownload.soe.ucsc.edu/goldenPath/hg38/chromosomes/chr1.fa.gz gunzip chr1.fa.gz 
```

Now you have `chr1.fa`â€”a clean reference for alignment.

``` bash
jayz@localhost:~/bioinformatics_practice/fastq_raw$ mkdir -p ~/bioinformatics_practice/reference
cd ~/bioinformatics_practice/reference
wget https://hgdownload.soe.ucsc.edu/goldenPath/hg38/chromosomes/chr1.fa.gz
gunzip chr1.fa.gz
--2025-09-18 16:28:13--  https://hgdownload.soe.ucsc.edu/goldenPath/hg38/chromosomes/chr1.fa.gz
Resolving hgdownload.soe.ucsc.edu (hgdownload.soe.ucsc.edu)... 128.114.119.163
Connecting to hgdownload.soe.ucsc.edu (hgdownload.soe.ucsc.edu)|128.114.119.163|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 74778116 (71M) [application/x-gzip]
Saving to: â€˜chr1.fa.gzâ€™

chr1.fa.gz                    100%[=================================================>]  71.31M  11.0MB/s    in 19s

2025-09-18 16:28:35 (3.73 MB/s) - â€˜chr1.fa.gzâ€™ saved [74778116/74778116]
```

### ğŸ› ï¸ Step 3: Index the Reference

Use BWA to index it:

``` bash
bwa index chr1.fa 
```

This creates `.amb`, `.ann`, `.bwt`, `.pac`, and `.sa` filesâ€”needed for alignment.

``` bash

jayz@localhost:~/bioinformatics_practice/reference$ bwa index chr1.fa
[bwa_index] Pack FASTA... 1.01 sec
[bwa_index] Construct BWT for the packed sequence...
[BWTIncCreate] textLength=497912844, availableWord=47034604
[BWTIncConstructFromPacked] 10 iterations done. 76325452 characters processed.
[BWTIncConstructFromPacked] 20 iterations done. 142216380 characters processed.
[BWTIncConstructFromPacked] 30 iterations done. 200776364 characters processed.
[BWTIncConstructFromPacked] 40 iterations done. 252820604 characters processed.
[BWTIncConstructFromPacked] 50 iterations done. 299073676 characters processed.
[BWTIncConstructFromPacked] 60 iterations done. 340179500 characters processed.
[BWTIncConstructFromPacked] 70 iterations done. 376710428 characters processed.
[BWTIncConstructFromPacked] 80 iterations done. 409175164 characters processed.
[BWTIncConstructFromPacked] 90 iterations done. 438025868 characters processed.
[BWTIncConstructFromPacked] 100 iterations done. 463664428 characters processed.
[BWTIncConstructFromPacked] 110 iterations done. 486447996 characters processed.
[bwt_gen] Finished constructing BWT in 116 iterations.
[bwa_index] 140.08 seconds elapse.
[bwa_index] Update BWT... 0.80 sec
[bwa_index] Pack forward-only FASTA... 0.67 sec
[bwa_index] Construct SA from BWT and Occ... 73.27 sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa index chr1.fa
[main] Real time: 628.709 sec; CPU: 215.820 sec
```

### ğŸ“ BWA Index Files Explained

| File Name | Purpose |
|------------------------------------|------------------------------------|
| `chr1.fa` | The original reference genome in FASTA format |
| `chr1.fa.amb` | Records ambiguous bases (e.g., N) in the reference |
| `chr1.fa.ann` | Annotation file: sequence names, lengths, and other metadata |
| `chr1.fa.bwt` | Burrows-Wheeler Transform of the reference sequenceâ€”core of the FM-index |
| `chr1.fa.pac` | Packed version of the reference (4 bases per byte) for efficient storage |
| `chr1.fa.sa` | Suffix array used for fast substring search during alignment |

``` bash
jayz@localhost:~/bioinformatics_practice/reference$ bwa mem chr1.fa ../fastq_subset/SRR9693121_1_subset.fastq > aligned.sam
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::process] read 100000 sequences (5100000 bp)...
[M::mem_process_seqs] Processed 100000 reads in 1.057 CPU sec, 0.998 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem chr1.fa ../fastq_subset/SRR9693121_1_subset.fastq
[main] Real time: 1.285 sec; CPU: 1.349 sec
jayz@localhost:~/bioinformatics_practice/reference$ samtools view -S -b aligned.sam > aligned.bam
jayz@localhost:~/bioinformatics_practice/reference$ samtools sort aligned.bam -o aligned.sorted.bam
jayz@localhost:~/bioinformatics_practice/reference$ samtools index aligned.sorted.bam
jayz@localhost:~/bioinformatics_practice/reference$ samtools flagstat aligned.sorted.bam
100000 + 0 in total (QC-passed reads + QC-failed reads)
100000 + 0 primary
0 + 0 secondary
0 + 0 supplementary
0 + 0 duplicates
0 + 0 primary duplicates
70 + 0 mapped (0.07% : N/A)
70 + 0 primary mapped (0.07% : N/A)
0 + 0 paired in sequencing
0 + 0 read1
0 + 0 read2
0 + 0 properly paired (N/A : N/A)
0 + 0 with itself and mate mapped
0 + 0 singletons (N/A : N/A)
0 + 0 with mate mapped to a different chr
0 + 0 with mate mapped to a different chr (mapQ>=5)
```

### ğŸ“Š Key Metrics Explained

| Metric | Meaning |
|------------------------------------|------------------------------------|
| `100000 + 0 in total` | You had 100,000 reads in total (all passed QC) |
| `100000 + 0 primary` | All reads are primary (not secondary or supplementary) |
| `70 + 0 mapped (0.07%)` | Only **70 reads** successfully aligned to the reference genome |
| `0 + 0 paired in sequencing` | No paired-end reads detected (you used single-end data) |
| `0 + 0 properly paired` | Not applicable for single-end reads |
| `0 + 0 duplicates` | No duplicate reads detected |
| `0 + 0 singletons` | Again, not applicable for single-end reads |

### âš ï¸ Why Is Mapping So Low?

Only **0.07%** of your reads mapped. Thatâ€™s extremely low. Here are possible reasons:

1.  **Reference Mismatch**: You used **human chromosome 1** (`chr1.fa`) as reference, but the reads might come from other chromosomes or even a different organism.

2.  **Subset Bias**: The sampled reads might not include any that match chr1.

3.  **Read Quality**: If the reads are low-quality or adapter-contaminated, they may fail to align.

4.  **Truncated Reference**: Using only one chromosome limits alignment potential.

### âœ… What You Can Do Next

1.  **Use Full Human Genome** Instead of just `chr1.fa`, download the full GRCh38 reference:

    ``` bash
    wget ftp://ftp.ensembl.org/pub/release-110/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz
    gunzip Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz
    bwa index Homo_sapiens.GRCh38.dna.primary_assembly.fa
    ```

2.  **Try Mapping to RNA-seq Reference** If your data is RNA-seq, use a splice-aware aligner like **HISAT2** or **STAR**, and include a GTF annotation file.

3.  **Run FastQC** Check read quality:

    ``` bash
    fastqc ../fastq_subset/SRR9693121_1_subset.fa
    ```

### First part : download the whole reference not just `chr1.fa`

``` bash
 wget ftp://ftp.ensembl.org/pub/release-110/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz
gunzip Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz
bwa index Homo_sapiens.GRCh38.dna.primary_assembly.fa
--2025-09-18 16:47:44--  ftp://ftp.ensembl.org/pub/release-110/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz
           => â€˜Homo_sapiens.GRCh38.dna.primary_assembly.fa.gzâ€™
Resolving ftp.ensembl.org (ftp.ensembl.org)... 193.62.193.169
Connecting to ftp.ensembl.org (ftp.ensembl.org)|193.62.193.169|:21... connected.
Logging in as anonymous ... Logged in!
==> SYST ... done.    ==> PWD ... done.
==> TYPE I ... done.  ==> CWD (1) /pub/release-110/fasta/homo_sapiens/dna ... done.
==> SIZE Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz ... 881964081
==> PASV ... done.    ==> RETR Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz ... done.
Length: 881964081 (841M) (unauthoritative)

Homo_sapiens.GRCh38.dna.prima 100%[=================================================>] 841.11M  3.08MB/s    in 26m 24s

2025-09-18 17:15:11 (544 KB/s) - â€˜Homo_sapiens.GRCh38.dna.primary_assembly.fa.gzâ€™ saved [881964081]

[bwa_index] Pack FASTA... 12.01 sec
[bwa_index] Construct BWT for the packed sequence...
[BWTIncCreate] textLength=6199501436, availableWord=448219384
[BWTIncConstructFromPacked] 10 iterations done. 99999996 characters processed.
[BWTIncConstructFromPacked] 20 iterations done. 199999996 characters processed.
Â·Â·Â·
[BWTIncConstructFromPacked] 650 iterations done. 6103943980 characters processed.
[BWTIncConstructFromPacked] 660 iterations done. 6133783772 characters processed.
[BWTIncConstructFromPacked] 670 iterations done. 6160301452 characters processed.
[BWTIncConstructFromPacked] 680 iterations done. 6183866396 characters processed.
[bwt_gen] Finished constructing BWT in 688 iterations.
[bwa_index] 2200.51 seconds elapse.
[bwa_index] Update BWT... 10.72 sec
[bwa_index] Pack forward-only FASTA... 16.79 sec
[bwa_index] Construct SA from BWT and Occ...
1648.22 sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa index Homo_sapiens.GRCh38.dna.primary_assembly.fa
[main] Real time: 4656.355 sec; CPU: 3888.248 sec
```

## Step 1: Quality Control with FastQC

### âœ… Install FastQC (if not already)

``` bash
sudo apt update sudo apt install fastqc 
```

### ğŸ“Š Run FastQC on the original FASTQ

``` bash
mkdir -p ~/bioinformatics_practice/qc_reports fastqc -o ~/bioinformatics_practice/qc_reports ~/bioinformatics_practice/raw_fastq/SRR9693121_1.fastq
```

This will generate:

-   An `.html` report (open in browser)

-   A `.zip` file with detailed metrics

You can preview results like:

-   Per base sequence quality

-   GC content

-   Adapter contamination

-   Overrepresented sequences

-   <div>

    ### âœ‚ï¸ Tools That *Do* Trim and Filter

    </div>

    | Tool | What It Does | Notes |
    |------------------------|------------------------|------------------------|
    | **Trim Galore!** | Adapter trimming + quality filtering | Wraps FastQC + Cutadapt |
    | **Cutadapt** | Precise adapter removal | Highly customizable |
    | **fastp** | All-in-one QC, trimming, filtering | Fast, multithreaded, generates reports |
    | **AfterQC** | Automatic trimming, filtering, error correction | Especially good for Illumina data2 |

``` bash
jayz@localhost:~/bioinformatics_practice/fastq_raw$ fastqc -o ../qc_reports SRR9693121_1.fastq
null
Started analysis of SRR9693121_1.fastq
Approx 5% complete for SRR9693121_1.fastq
Approx 10% complete for SRR9693121_1.fastq
Approx 15% complete for SRR9693121_1.fastq
Approx 20% complete for SRR9693121_1.fastq
Approx 25% complete for SRR9693121_1.fastq
Approx 30% complete for SRR9693121_1.fastq
Approx 35% complete for SRR9693121_1.fastq
Approx 40% complete for SRR9693121_1.fastq
Approx 45% complete for SRR9693121_1.fastq
Approx 50% complete for SRR9693121_1.fastq
Approx 55% complete for SRR9693121_1.fastq
Approx 60% complete for SRR9693121_1.fastq
Approx 65% complete for SRR9693121_1.fastq
Approx 70% complete for SRR9693121_1.fastq
Approx 75% complete for SRR9693121_1.fastq
Approx 80% complete for SRR9693121_1.fastq
Approx 85% complete for SRR9693121_1.fastq
Approx 90% complete for SRR9693121_1.fastq
Approx 95% complete for SRR9693121_1.fastq
Analysis complete for SRR9693121_1.fastq
```

check the file

``` bash
jayz@localhost:~/bioinformatics_practice/fastq_raw$ ls
SRR9693121_1.fastq  fasterq.tmp.localhost.1507
jayz@localhost:~/bioinformatics_practice/fastq_raw$ cd ~/bioinformatics_practice/qc_reports
jayz@localhost:~/bioinformatics_practice/qc_reports$ ls *.html
SRR9693121_1_fastqc.html
```

check the output of html by firebox

``` bash
jayz@localhost:~/bioinformatics_practice/qc_reports$ sudo snap install firefox
2025-09-18T18:47:36+08:00 INFO Waiting for automatic snapd restart...
firefox 142.0.1-1 from Mozillaâœ“ installed
jayz@localhost:~/bioinformatics_practice/qc_reports$ ls
SRR9693121_1_fastqc.html  SRR9693121_1_fastqc.zip
jayz@localhost:~/bioinformatics_practice/qc_reports$ firefox SRR9693121_1_fastqc.html
touch: cannot touch '/home/jayz/snap/firefox/common/.cache/desktop-runtime-date': No such file or directory
[5376, Main Thread] WARNING: Failed to read portal settings: GDBus.Error:org.freedesktop.DBus.Error.ServiceUnknown: The name org.freedesktop.portal.Desktop was not provided by any .service files: 'glib warning', file /build/firefox/parts/firefox/build/toolkit/xre/nsSigHandlers.cpp:201
```

## âœ‚ï¸ Step 2: Clean the Data with Trim Galore!

### âœ… 1. **Install Cutadapt (Trim Galore depends on it)**

``` bash
sudo apt install cutadapt 
```

### âœ… 2. **Download and Set Up Trim Galore**

``` bash
wget https://github.com/FelixKrueger/TrimGalore/archive/refs/heads/master.zip unzip master.zip cd TrimGalore-master chmod +x trim_galore 
```

You can now run `./trim_galore` from this folder.

``` bash
jayz@localhost:~/bioinformatics_practice/qc_reports/TrimGalore-master$ mkdir -p ~/bioinformatics_practice/clean_fastq
./trim_galore --quality 20 --length 36 --illumina \
-o ~/bioinformatics_practice/clean_fastq \
~/bioinformatics_practice/fastq_raw/SRR9693121_1.fastq
Multicore support not enabled. Proceeding with single-core trimming.

Output will be written into the directory: /home/jayz/bioinformatics_practice/clean_fastq/
Writing report to '/home/jayz/bioinformatics_practice/clean_fastq/SRR9693121_1.fastq_trimming_report.txt'

SUMMARISING RUN PARAMETERS
==========================
Input filename: /home/jayz/bioinformatics_practice/fastq_raw/SRR9693121_1.fastq
Trimming mode: single-end
Trim Galore version: 0.6.10
Cutadapt version: 4.4
Number of cores used for trimming: 1
Quality Phred score cutoff: 20
Quality encoding type selected: ASCII+33
Adapter sequence: 'AGATCGGAAGAGC' (Illumina TruSeq, Sanger iPCR; user defined)
Maximum trimming error rate: 0.1 (default)
Minimum required adapter overlap (stringency): 1 bp
Minimum required sequence length before a sequence gets removed: 36 bp

Cutadapt seems to be fairly up-to-date (version 4.4). Setting -j 1
Writing final adapter and quality trimmed output to SRR9693121_1_trimmed.fq


  >>> Now performing quality (cutoff '-q 20') and adapter trimming in a single pass for the adapter sequence: 'AGATCGGAAGAGC' from file /home/jayz/bioinformatics_practice/fastq_raw/SRR9693121_1.fastq <<<
10000000 sequences processed
20000000 sequences processed
This is cutadapt 4.4 with Python 3.12.3
Command line parameters: -j 1 -e 0.1 -q 20 -O 1 -a AGATCGGAAGAGC /home/jayz/bioinformatics_practice/fastq_raw/SRR9693121_1.fastq
Processing single-end reads on 1 core ...
Finished in 78.993 s (3.319 Âµs/read; 18.08 M reads/minute).

=== Summary ===

Total reads processed:              23,802,308
Reads with adapters:                20,623,778 (86.6%)
Reads written (passing filters):    23,802,308 (100.0%)

Total basepairs processed: 1,213,917,708 bp
Quality-trimmed:                 449,346 bp (0.0%)
Total written (filtered):  1,173,401,657 bp (96.7%)

=== Adapter 1 ===

Sequence: AGATCGGAAGAGC; Type: regular 3'; Length: 13; Trimmed: 20623778 times

Minimum overlap: 1
No. of allowed errors:
1-9 bp: 0; 10-13 bp: 1

Bases preceding removed adapters:
  A: 0.3%
  C: 99.3%
  G: 0.3%
  T: 0.0%
  none/other: 0.0%
WARNING:
    The adapter is preceded by 'C' extremely often.
    The provided adapter sequence could be incomplete at its 5' end.
    Ignore this warning when trimming primers.

Overview of removed sequences
length  count   expect  max.err error counts
1       1181485 5950577.0       0       1181485
2       19442025        1487644.2       0       19442025
3       259     371911.1        0       259
5       1       23244.4 0       1
47      2       0.4     1       0 2
49      6       0.4     1       0 6


WARNING:
    One or more of your adapter sequences may be incomplete.
    Please see the detailed output above.

RUN STATISTICS FOR INPUT FILE: /home/jayz/bioinformatics_practice/fastq_raw/SRR9693121_1.fastq
=============================================
23802308 sequences processed in total
Sequences removed because they became shorter than the length cutoff of 36 bp:  467 (0.0%)
```

## âœ… Key Takeaways from Your Cutadapt Report

### ğŸ”¬ Adapter Removal

-   **Adapter detected**: `AGATCGGAAGAGC` (Illumina universal adapter)

-   **Reads with adapters**: **20.6 million** out of 23.8 million â†’ **86.6%**

-   **Trimmed occurrences**: 20,623,778 times

Thatâ€™s a high adapter presence, which is typical for RNA-seq data. You cleaned it thoroughly.

### ğŸ“‰ Quality Trimming

-   **Quality cutoff**: Phred score 20

-   **Bases trimmed due to low quality**: 449,346 bp (only 0.04%)

-   This means your reads were generally high-qualityâ€”great news.

### ğŸ“ Length Filtering

-   **Minimum read length**: 36 bp

-   **Reads discarded for being too short**: 467 (negligible)

### âš ï¸ Adapter Warning

> â€œThe adapter is preceded by 'C' extremely oftenâ€¦ may be incomplete at its 5' end.â€

This is common and not a problem unless you're trimming primers. You can safely ignore it for standard Illumina adapter trimming.

### ğŸ§¼ 3. **Run Trim Galore on Your FASTQ File**

Assuming your file is single-end and located at `~/bioinformatics_practice/fastq_raw/SRR9693121_1.fastq`, run:

``` bash
mkdir -p ~/bioinformatics_practice/clean_fastq ./trim_galore --quality 20 --length 36 --illumina \ -o ~/bioinformatics_practice/clean_fastq \ ~/bioinformatics_practice/fastq_raw/SRR9693121_1.fastq 
```

#### What this does:

-   `--quality 20`: trims bases with Phred score \< 20

-   `--length 36`: removes reads shorter than 36 bp

-   `--illumina`: auto-detects and removes Illumina adapters

-   `-o`: sets output directory

### ğŸ“Š 4. **Check the Output**

Youâ€™ll get:

-   A cleaned FASTQ file: `SRR9693121_1_trimmed.fq`

-   A `.txt` trimming report

-   Optionally, a new FastQC report if you add `--fastqc`

To re-run FastQC on the cleaned file:

``` bash
fastqc -o ~/bioinformatics_practice/qc_reports ~/bioinformatics_practice/clean_fastq/SRR9693121_1_trimmed.fq 
```

``` bash
jayz@localhost:~/bioinformatics_practice/qc_reports/TrimGalore-master$ ls
CHANGELOG.md  Docs  LICENSE  README.md  test_files  trim_galore
jayz@localhost:~/bioinformatics_practice/qc_reports/TrimGalore-master$ ls ~/bioinformatics_practice/clean_fastq/
SRR9693121_1.fastq_trimming_report.txt  SRR9693121_1_trimmed.fq
jayz@localhost:~/bioinformatics_practice/qc_reports/TrimGalore-master$ fastqc -o ~/bioinformatics_practice/qc_reports ~/bioinformatics_practice/clean_fastq/SRR9693121_1_trimmed.fq
null
Started analysis of SRR9693121_1_trimmed.fq
Approx 5% complete for SRR9693121_1_trimmed.fq
Approx 10% complete for SRR9693121_1_trimmed.fq
Approx 15% complete for SRR9693121_1_trimmed.fq
Approx 20% complete for SRR9693121_1_trimmed.fq
Approx 25% complete for SRR9693121_1_trimmed.fq
Approx 30% complete for SRR9693121_1_trimmed.fq
Approx 35% complete for SRR9693121_1_trimmed.fq
Approx 40% complete for SRR9693121_1_trimmed.fq
Approx 45% complete for SRR9693121_1_trimmed.fq
Approx 50% complete for SRR9693121_1_trimmed.fq
Approx 55% complete for SRR9693121_1_trimmed.fq
Approx 60% complete for SRR9693121_1_trimmed.fq
Approx 65% complete for SRR9693121_1_trimmed.fq
Approx 70% complete for SRR9693121_1_trimmed.fq
Approx 75% complete for SRR9693121_1_trimmed.fq
Approx 80% complete for SRR9693121_1_trimmed.fq
Approx 85% complete for SRR9693121_1_trimmed.fq
Approx 90% complete for SRR9693121_1_trimmed.fq
Approx 95% complete for SRR9693121_1_trimmed.fq
Analysis complete for SRR9693121_1_trimmed.fq
jayz@localhost:~/bioinformatics_practice/qc_reports/TrimGalore-master$ ls
CHANGELOG.md  Docs  LICENSE  README.md  test_files  trim_galore
jayz@localhost:~/bioinformatics_practice/qc_reports/TrimGalore-master$ cd  ~/bioinformatics_practice/qc_reports
jayz@localhost:~/bioinformatics_practice/qc_reports$ ls
SRR9693121_1_fastqc.html  SRR9693121_1_trimmed_fastqc.html  TrimGalore-master
SRR9693121_1_fastqc.zip   SRR9693121_1_trimmed_fastqc.zip   master.zip
jayz@localhost:~/bioinformatics_practice/qc_reports$ firefox  SRR9693121_1_trimmed_fastqc.html
[7415, Main Thread] WARNING: Failed to read portal settings: GDBus.Error:org.freedesktop.DBus.Error.ServiceUnknown: The name org.freedesktop.portal.Desktop was not provided by any .service files: 'glib warning', file /build/firefox/parts/firefox/build/toolkit/xre/nsSigHandlers.cpp:201
```

## âš¡ Step-by-Step: Run `fastp` for Quality Filtering

### âœ… 1. **Install fastp**

If you havenâ€™t already:

``` bash
sudo apt install fastp
```

### ğŸ§¼ 2. **Run fastp on Your Original FASTQ**

Letâ€™s clean the original file again using fastpâ€™s all-in-one capabilities:

``` bash
mkdir -p ~/bioinformatics_practice/fastp_clean fastp \ -i ~/bioinformatics_practice/fastq_raw/SRR9693121_1.fastq \ -o ~/bioinformatics_practice/fastp_clean/SRR9693121_1_fastp_clean.fastq \ --html ~/bioinformatics_practice/fastp_clean/SRR9693121_1_fastp_report.html \ --json ~/bioinformatics_practice/fastp_clean/SRR9693121_1_fastp_report.json \ -q 20 -u 30 -n 5 -l 36 
```

### ğŸ” What These Parameters Do:

-   `-q 20`: trim bases with quality \< Q20

-   `-u 30`: discard reads with \>30% low-quality bases

-   `-n 5`: discard reads with \>5 ambiguous bases (N)

-   `-l 36`: discard reads shorter than 36 bp

-   `--html` / `--json`: generate interactive reports

``` bash
Read1 before filtering: total reads: 23802308 total bases: 1213917708 Q20 bases: 1204979833(99.2637%) Q30 bases: 1200331563(98.8808%) Read1 after filtering: total reads: 23753330 total bases: 1211419830 Q20 bases: 1203369349(99.3355%) Q30 bases: 1198912027(98.9675%) Filtering result: reads passed filter: 23753330 reads failed due to low quality: 48978 reads failed due to too many N: 0 reads failed due to too short: 0 reads with adapter trimmed: 0 bases trimmed due to adapters: 0 Duplication rate (may be overestimated since this is SE data): 99.2325%
```

### âœ… ä½¿ç”¨å®Œæ•´å‚è€ƒåŸºå› ç»„

å·²ç»ä¸‹è½½å¹¶ç´¢å¼•äº†å®Œæ•´çš„ GRCh38ï¼š

### âœ… ä»€ä¹ˆæ˜¯ GRCh38 Primary Assemblyï¼Ÿ

å®ƒåŒ…å«ä»¥ä¸‹ä¸‰éƒ¨åˆ†ï¼š

1.  **Chromosomal assembly**ï¼šæ ‡å‡†çš„ 1â€“22 æ¡å¸¸æŸ“è‰²ä½“ + Xã€Yã€MTï¼ˆçº¿ç²’ä½“ï¼‰

2.  **Unlocalized contigs**ï¼šå·²çŸ¥å±äºæŸæ¡æŸ“è‰²ä½“ï¼Œä½†å…·ä½“ä½ç½®æœªçŸ¥çš„åºåˆ—

3.  **Unplaced contigs**ï¼šæŸ“è‰²ä½“å½’å±æœªçŸ¥çš„åºåˆ—

è¿™äº›æ„æˆäº†æ‰€è°“çš„ **primary assembly**ï¼Œæ˜¯ Ensembl æ¨èç”¨äºå¤§å¤šæ•°åˆ†æçš„ç‰ˆæœ¬ã€‚

``` bash
Homo_sapiens.GRCh38.dna.primary_assembly.fa 
```

é‡æ–°è¿è¡Œ BWAï¼š

``` bash
bwa mem Homo_sapiens.GRCh38.dna.primary_assembly.fa ../fastp_clean/SRR9693121_1_fastp_clean.fastq > aligned_full.sam samtools view -S -b aligned_full.sam > aligned_full.bam samtools sort aligned_full.bam -o aligned_full.sorted.bam samtools index aligned_full.sorted.bam samtools flagstat aligned_full.sorted.bam
```

```         
[bam_sort_core] merging from 5 files and 1 in-memory blocks...
23753330 + 0 in total (QC-passed reads + QC-failed reads)
23753330 + 0 primary
0 + 0 secondary
0 + 0 supplementary
0 + 0 duplicates
0 + 0 primary duplicates
109285 + 0 mapped (0.46% : N/A)
109285 + 0 primary mapped (0.46% : N/A)
0 + 0 paired in sequencing
0 + 0 read1
0 + 0 read2
0 + 0 properly paired (N/A : N/A)
0 + 0 with itself and mate mapped
0 + 0 singletons (N/A : N/A)
0 + 0 with mate mapped to a different chr
0 + 0 with mate mapped to a different chr (mapQ>=5)
```

**SRR9693121** æ˜¯æ¥è‡ª **Rattus norvegicusï¼ˆè¤å®¶é¼ ï¼‰** çš„ **miRNA-Seq** æ•°æ®ã€‚è¿™è§£é‡Šäº†ä½ ä¹‹å‰é‡åˆ°çš„æ¯”å¯¹ç‡æä½çš„é—®é¢˜â€”â€”ä½ ä¸€ç›´åœ¨ç”¨äººç±»å‚è€ƒåŸºå› ç»„ï¼ˆGRCh38ï¼‰è¿›è¡Œæ¯”å¯¹ï¼Œè€Œä½ çš„æ•°æ®å…¶å®æ˜¯æ¥è‡ªè€é¼  ğŸ­ã€‚

## ğŸ§  æ•°æ®é›†å…³é”®ä¿¡æ¯

| é¡¹ç›®         | å†…å®¹                                |
|--------------|-------------------------------------|
| **ç‰©ç§**     | Rattus norvegicusï¼ˆè¤å®¶é¼ ï¼‰         |
| **æµ‹åºç±»å‹** | miRNA-Seq                           |
| **å¹³å°**     | Illumina NextSeq 500                |
| **æ€» reads** | 23.8M                               |
| **æ¥æº**     | è‚Œè‚‰å¹²ç»†èƒï¼Œè„‚è´¨å› å­å¤„ç†            |
| **å»ºåº“æ–¹æ³•** | Norgen Biotek å° RNA æ–‡åº“åˆ¶å¤‡è¯•å‰‚ç›’ |
| **å¸ƒå±€**     | å•ç«¯ï¼ˆSingle-endï¼‰                  |
| **é€‰æ‹©æ–¹å¼** | å°ºå¯¸åˆ†çº§ï¼ˆsize fractionationï¼‰      |

## â— ä¸ºä»€ä¹ˆäººç±»å‚è€ƒåŸºå› ç»„æ— æ³•æ¯”å¯¹

ä½ çš„ reads æ˜¯æ¥è‡ªè€é¼ çš„ microRNAï¼Œè€Œä½ ç”¨çš„æ˜¯äººç±»çš„å‚è€ƒåŸºå› ç»„ï¼ˆGRCh38ï¼‰ï¼Œè¿™ä¸¤ä¸ªç‰©ç§ä¹‹é—´å·®å¼‚å·¨å¤§ï¼Œå°¤å…¶æ˜¯åœ¨éç¼–ç  RNA åŒºåŸŸã€‚è‡ªç„¶å°±å¯¼è‡´äº†æ¯”å¯¹ç‡å‡ ä¹ä¸ºé›¶ã€‚

## âœ… æ­£ç¡®åšæ³•ï¼šä½¿ç”¨è€é¼ å‚è€ƒåŸºå› ç»„

ä½ å¯ä»¥ä¸‹è½½ Ensembl æä¾›çš„ Rattus norvegicus çš„å‚è€ƒåŸºå› ç»„ï¼š

## ğŸ“¥ ä¸‹è½½å‚è€ƒåŸºå› ç»„ï¼ˆFASTAï¼‰

bash

```         
# ä¸‹è½½ GRCr8 çš„åŸºå› ç»„åºåˆ—
wget https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/036/323/735/GCA_036323735.1_GRCr8/GCA_036323735.1_GRCr8_genomic.fna.gz

# è§£å‹
gunzip GCA_036323735.1_GRCr8_genomic.fna.gz
```

## ä¸‹è½½åŸºå› æ³¨é‡Šæ–‡ä»¶ï¼ˆGTFï¼‰

bash

```         
# ä¸‹è½½å¯¹åº”çš„ GTF æ³¨é‡Šæ–‡ä»¶ wget https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/036/323/735/GCA_036323735.1_GRCr8/GCA_036323735.1_GRCr8_genomic.gtf.gz  # è§£å‹ gunzip GCA_036323735.1_GRCr8_genomic.gtf.gz 
```

ä½ åˆšæ‰å°è¯•ä¸‹è½½çš„ GTF æ–‡ä»¶ï¼š

bash

```         
https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/036/323/735/GCA_036323735.1_GRCr8/GCA_036323735.1_GRCr8_genomic.gtf.gz 
```

è¿”å›äº† **404 é”™è¯¯**ï¼Œè¯´æ˜è¿™ä¸ªè·¯å¾„ä¸‹å¹¶æ²¡æœ‰æä¾› GTF æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸º NCBI çš„ GenBank ç‰ˆæœ¬ï¼ˆGCA\_ï¼‰é€šå¸¸**ä¸åŒ…å«æ³¨é‡Šæ–‡ä»¶**ï¼Œè€Œ GTF æ–‡ä»¶æ˜¯ç”± **RefSeqï¼ˆGCF\_ï¼‰ç‰ˆæœ¬**æä¾›çš„ã€‚

## âœ… æ­£ç¡®ä¸‹è½½ GTF æ³¨é‡Šæ–‡ä»¶çš„æ–¹æ³•

ä½ åº”è¯¥ä½¿ç”¨ RefSeq ç‰ˆæœ¬çš„ GRCr8ï¼Œå³ï¼š

ä»£ç 

```         
GCF_036323735.1_GRCr8 
```

### ğŸ“¥ ä¸‹è½½å‘½ä»¤å»ºè®®ï¼š

bash

```         
wget https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/036/323/735/GCF_036323735.1_GRCr8/GCF_036323735.1_GRCr8_genomic.gtf.gz gunzip GCF_036323735.1_GRCr8_genomic.gtf.gz 
```

è¿™ä¸ªè·¯å¾„æ˜¯ NCBI RefSeq å®˜æ–¹æä¾›çš„æ³¨é‡Šæ–‡ä»¶ï¼Œé€‚ç”¨äºä½ ä¹‹å‰ä¸‹è½½çš„ GRCr8 åŸºå› ç»„åºåˆ—ã€‚

## ğŸ§¬ æ„å»º BWA ç´¢å¼•

bash

```         
# ä½¿ç”¨ BWA æ„å»ºç´¢å¼• bwa index GCA_036323735.1_GRCr8_genomic.fna 
```

è¿™ä¸€æ­¥ä¼šç”Ÿæˆ `.amb`, `.ann`, `.bwt`, `.pac`, `.sa` ç­‰ç´¢å¼•æ–‡ä»¶ï¼Œç”¨äºåç»­æ¯”å¯¹ã€‚

## ğŸ§  ä¸ºä»€ä¹ˆè¦è¿è¡Œ `bwa index`

BWA æ˜¯ä¸€ä¸ªæ¯”å¯¹å·¥å…·ï¼Œå®ƒä¸èƒ½ç›´æ¥ä½¿ç”¨åŸå§‹çš„ `.fna` æˆ– `.fa` æ–‡ä»¶è¿›è¡Œæ¯”å¯¹ã€‚å®ƒéœ€è¦å…ˆæŠŠå‚è€ƒåŸºå› ç»„è½¬æ¢æˆä¸€ç§**ä¸“ç”¨çš„ç´¢å¼•æ ¼å¼**ï¼Œè¿™æ ·æ‰èƒ½å¿«é€Ÿå®šä½æ¯æ¡ read åœ¨åŸºå› ç»„ä¸­çš„ä½ç½®ã€‚

### ğŸ“¦ ç´¢å¼•æ–‡ä»¶åŒ…å«çš„å†…å®¹ï¼š

è¿è¡Œ `bwa index` åï¼Œä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

-   `.amb`ï¼šç¢±åŸºä¿¡æ¯

-   `.ann`ï¼šæ³¨é‡Šä¿¡æ¯

-   `.bwt`ï¼šBurrows-Wheeler Transformï¼ˆæ ¸å¿ƒå‹ç¼©ç»“æ„ï¼‰

-   `.pac`ï¼špacked sequence

-   `.sa`ï¼šsuffix arrayï¼ˆåŠ é€Ÿæœç´¢ï¼‰

è¿™äº›æ–‡ä»¶å…±åŒæ„æˆäº†ä¸€ä¸ªé«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œè®© BWA èƒ½å¤Ÿåœ¨å‡ ç§’é’Ÿå†…å®Œæˆæ•°ç™¾ä¸‡æ¡ reads çš„æ¯”å¯¹ã€‚

```         
[bwt_gen] Finished constructing BWT in 638 iterations.
[bwa_index] 2017.11 seconds elapse.
[bwa_index] Update BWT... 9.43 sec
[bwa_index] Pack forward-only FASTA... 14.31 sec
[bwa_index] Construct SA from BWT and Occ... 1668.93 sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa index GCA_036323735.1_GRCr8_genomic.fna
[main] Real time: 3720.950 sec; CPU: 3719.994 sec
jayz@localhost:~/bioinformatics_practice/reference$ bwa mem GCF_036323735.1_GRCr8_genomic.fna ../fastp_clean/SRR9693121_1_fastp_clean.fastq > aligned_rat.sam
[E::bwa_idx_load_from_disk] fail to locate the index files
jayz@localhost:~/bioinformatics_practice/reference$ ls
GCA_036323735.1_GRCr8_genomic.fna                aligned.sorted.bam.bai
GCA_036323735.1_GRCr8_genomic.fna.amb            aligned_fastp.bam
GCA_036323735.1_GRCr8_genomic.fna.ann            aligned_fastp.sam
GCA_036323735.1_GRCr8_genomic.fna.bwt            aligned_fastp.sorted.bam
GCA_036323735.1_GRCr8_genomic.fna.pac            aligned_fastp.sorted.bam.bai
GCA_036323735.1_GRCr8_genomic.fna.sa             aligned_full.bam
GCF_036323735.1_GRCr8_genomic.gtf                aligned_full.sam
Homo_sapiens.GRCh38.dna.primary_assembly.fa      aligned_full.sorted.bam
Homo_sapiens.GRCh38.dna.primary_assembly.fa.amb  aligned_full.sorted.bam.bai
Homo_sapiens.GRCh38.dna.primary_assembly.fa.ann  aligned_rat.sam
Homo_sapiens.GRCh38.dna.primary_assembly.fa.bwt  chr1.fa
Homo_sapiens.GRCh38.dna.primary_assembly.fa.pac  chr1.fa.amb
Homo_sapiens.GRCh38.dna.primary_assembly.fa.sa   chr1.fa.ann
aligned.bam                                      chr1.fa.bwt
aligned.sam                                      chr1.fa.pac
aligned.sorted.bam                               chr1.fa.sa
```

### ğŸš€ Step 2ï¼šè¿è¡Œ BWA æ¯”å¯¹

bash

```         
bwa mem GCA_036323735.1_GRCr8_genomic.fna ../fastp_clean/SRR9693121_1_fastp_clean.fastq > aligned_rat.sam 
```

è¿™ä¸€æ­¥ä¼šç”Ÿæˆ `aligned_rat.sam`ï¼ŒåŒ…å«æ‰€æœ‰æ¯”å¯¹ä¿¡æ¯ã€‚

```         
[M::mem_process_seqs] Processed 27650 reads in 0.443 CPU sec, 0.387 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem GCA_036323735.1_GRCr8_genomic.fna ../fastp_clean/SRR9693121_1_fastp_clean.fastq
[main] Real time: 342.553 sec; CPU: 356.735 sec
```

### ğŸ§± Step 3ï¼šè½¬æ¢ä¸º BAMã€æ’åºå¹¶ç´¢å¼•

bash

```         
samtools view -S -b aligned_rat.sam > aligned_rat.bam
samtools sort aligned_rat.bam -o aligned_rat.sorted.bam
samtools index aligned_rat.sorted.bam
```

```         
jayz@localhost:~/bioinformatics_practice/reference$ samtools flagstat aligned_rat.sorted.bam
23753330 + 0 in total (QC-passed reads + QC-failed reads)
23753330 + 0 primary
0 + 0 secondary
0 + 0 supplementary
0 + 0 duplicates
0 + 0 primary duplicates
125236 + 0 mapped (0.53% : N/A)
125236 + 0 primary mapped (0.53% : N/A)
0 + 0 paired in sequencing
0 + 0 read1
0 + 0 read2
0 + 0 properly paired (N/A : N/A)
0 + 0 with itself and mate mapped
0 + 0 singletons (N/A : N/A)
0 + 0 with mate mapped to a different chr
0 + 0 with mate mapped to a different chr (mapQ>=5)
```

## å½“å‰æ¯”å¯¹ç»“æœæ€»ç»“

| æŒ‡æ ‡                 | æ•°å€¼             |
|----------------------|------------------|
| æ€» reads             | 23,753,330       |
| æˆåŠŸæ¯”å¯¹             | 125,236          |
| æ¯”å¯¹ç‡               | **0.53%**        |
| é…å¯¹ä¿¡æ¯             | å•ç«¯æ•°æ®ï¼Œæ— é…å¯¹ |
| é‡å¤ã€è¡¥å……ã€æ¬¡çº§æ¯”å¯¹ | å…¨éƒ¨ä¸º 0         |

## ğŸ§  å¯èƒ½åŸå› åˆ†æ

### 1. âŒ å‚è€ƒåŸºå› ç»„ä¸åŒ¹é…

ä½ ä½¿ç”¨çš„æ˜¯ **GCA_036323735.1_GRCr8_genomic.fna**ï¼Œè¿™æ˜¯ rat çš„å®Œæ•´åŸºå› ç»„ã€‚ä½† miRNA-Seq æ•°æ®é€šå¸¸æ˜¯éå¸¸çŸ­çš„åºåˆ—ï¼ˆ18â€“24 ntï¼‰ï¼Œè€Œ rat çš„åŸºå› ç»„åŒ…å«å¤§é‡é miRNA åŒºåŸŸã€‚å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨ä¸“é—¨çš„ miRNA åº“æˆ–æ³¨é‡Šï¼Œå¾ˆå¤š reads ä¼šæ— æ³•æ¯”å¯¹ã€‚

### 2. âš ï¸ æ²¡æœ‰ä½¿ç”¨ miRNA ä¸“å±å‚è€ƒ

miRNA-Seq é€šå¸¸ä½¿ç”¨çš„æ˜¯ï¼š

-   miRBase æä¾›çš„ mature miRNA åºåˆ—ï¼ˆFASTAï¼‰

-   æˆ–è€… Ensembl çš„ ncRNA æ³¨é‡Šï¼ˆGTFï¼‰

ä½ ç›®å‰ä½¿ç”¨çš„æ˜¯æ•´ä¸ªåŸºå› ç»„ä½œä¸ºå‚è€ƒï¼Œè¿™å¯¹äº miRNA æ¥è¯´å¯èƒ½å¤ªâ€œå®½æ³›â€äº†ã€‚

### 3. âš ï¸ å»ºåº“æ–¹å¼æˆ–æµ‹åºè´¨é‡é—®é¢˜

-   æ˜¯å¦æ˜¯ 3' adapter å»ºåº“ï¼Ÿ

-   æ˜¯å¦æœ‰ poly-A å°¾ï¼Ÿ

-   æ˜¯å¦æ¸…æ´—äº† adapterï¼Ÿ

-   æ˜¯å¦æ˜¯ rat æ ·æœ¬ä½†ç”¨äº†äººç±» miRNA åº“ï¼Ÿ

## ğŸ—‚ï¸ ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹æ•´ä¸ªé¡¹ç›®æ–‡ä»¶ç»“æ„

ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨é¡¹ç›®æ ¹ç›®å½•æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ï¼š

bash

```         
tree -h -L 3 ~/bioinformatics_practice 
```

-   `-h`ï¼šæ˜¾ç¤ºæ–‡ä»¶å¤§å°

-   `-L 3`ï¼šæœ€å¤šæ˜¾ç¤º 3 å±‚ç›®å½•ç»“æ„ï¼ˆä½ å¯ä»¥è°ƒæ•´ï¼‰

-   å¦‚æœæ²¡æœ‰å®‰è£… `tree`ï¼Œå¯ä»¥å…ˆè¿è¡Œï¼š`sudo apt install tree`

## âœ… ç¬¬äºŒæ­¥ï¼šå»ºè®®ä¿ç•™çš„å…³é”®ç»“æœæ–‡ä»¶

æ ¹æ®ä½ çš„æµç¨‹ï¼Œä»¥ä¸‹æ˜¯å€¼å¾—ä¿ç•™çš„æ–‡ä»¶ç±»å‹ï¼š

| æ–‡ä»¶ç±»å‹ | ç¤ºä¾‹æ–‡ä»¶å | ç”¨é€” |
|----|----|----|
| **æ¯”å¯¹ç»“æœ BAM** | `aligned_rat.sorted.bam` | åç»­è¡¨è¾¾é‡åˆ†æ |
| **BAM ç´¢å¼•** | `aligned_rat.sorted.bam.bai` | å¿«é€Ÿå®šä½ |
| **è¡¨è¾¾é‡è®¡æ•°ç»“æœ** | `counts.txt` | featureCounts è¾“å‡º |
| **miRNA æ³¨é‡Š GTF** | `miRNA_annotations.gtf` | æ³¨é‡Šå‚è€ƒ |
| **å‚è€ƒåŸºå› ç»„ FASTA** | `GCA_036323735.1_GRCr8_genomic.fna` | å¯å¤ç”¨ |
| **å‚è€ƒç´¢å¼•æ–‡ä»¶** | `.bwt`, `.pac`, `.amb`, `.ann`, `.sa` | BWA ç´¢å¼• |
| **FastQC æŠ¥å‘Š** | `*_fastqc.html` | è´¨é‡æ£€æŸ¥ç»“æœ |

## ğŸ§¹ ç¬¬ä¸‰æ­¥ï¼šåˆ é™¤ä¸­é—´æ–‡ä»¶å’ŒåŸå§‹æ•°æ®

ä½ å¯ä»¥åˆ é™¤ä»¥ä¸‹å†…å®¹ï¼š

-   åŸå§‹ FASTQ æ–‡ä»¶ï¼ˆå¦‚ `SRR9693121_1.fastq`ï¼‰

-   æ¸…æ´—åçš„ FASTQï¼ˆå¦‚ `*_fastp_clean.fastq`ï¼‰ï¼Œå¦‚æœä½ å·²ç»å®Œæˆæ¯”å¯¹

-   æ‰€æœ‰ `.sam` æ–‡ä»¶ï¼ˆå¦‚ `aligned_rat.sam`ï¼‰

-   ä¸´æ—¶ BAM æ–‡ä»¶ï¼ˆæœªæ’åºçš„ï¼‰

-   ä¸­é—´ QC æ–‡ä»¶ï¼ˆå¦‚ `.zip`ï¼‰

### åˆ é™¤å‘½ä»¤ç¤ºä¾‹ï¼š

bash

```         
rm ~/bioinformatics_practice/fastq_raw/*.fastq
rm ~/bioinformatics_practice/fastp_clean/*.fastq
rm ~/bioinformatics_practice/reference/*.sam
rm ~/bioinformatics_practice/reference/aligned*.bam
```

âš ï¸ **æ³¨æ„**ï¼šè¯·å…ˆç¡®è®¤ä½ å·²ç»ä¿ç•™äº† `aligned_rat.sorted.bam` å’Œ `.bai` æ–‡ä»¶ï¼

```         
jayz@localhost:~/bioinformatics_practice/mirbase_rno$
tree -h -L 3 ~/bioinformatics_practice
[4.0K]  /home/jayz/bioinformatics_practice
â”œâ”€â”€ [4.0K]  clean_fastq
â”‚Â Â  â”œâ”€â”€ [2.1K]  SRR9693121_1.fastq_trimming_report.txt
â”‚Â Â  â””â”€â”€ [3.1G]  SRR9693121_1_trimmed.fq
â”œâ”€â”€ [4.0K]  fasterq.tmp.localhost.1083
â”‚Â Â  â”œâ”€â”€ [ 25M]  SRR9693121.localhost.1083.0000.1
â”‚Â Â  â”œâ”€â”€ [ 26M]  SRR9693121.localhost.1083.0001.1
â”‚Â Â  â”œâ”€â”€ [ 40M]  SRR9693121.localhost.1083.0002.1
â”‚Â Â  â””â”€â”€ [ 27M]  SRR9693121.localhost.1083.0003.1
â”œâ”€â”€ [4.0K]  fastp_clean
â”‚Â Â  â”œâ”€â”€ [4.0G]  SRR9693121_1_fastp_clean.fastq
â”‚Â Â  â”œâ”€â”€ [213K]  SRR9693121_1_fastp_report.html
â”‚Â Â  â””â”€â”€ [ 46K]  SRR9693121_1_fastp_report.json
â”œâ”€â”€ [4.0K]  fastq_raw
â”‚Â Â  â”œâ”€â”€ [4.0G]  SRR9693121_1.fastq
â”‚Â Â  â””â”€â”€ [4.0K]  fasterq.tmp.localhost.1507
â”‚Â Â      â”œâ”€â”€ [137M]  SRR9693121.localhost.1507.0000.1
â”‚Â Â      â”œâ”€â”€ [157M]  SRR9693121.localhost.1507.0001.1
â”‚Â Â      â”œâ”€â”€ [149M]  SRR9693121.localhost.1507.0002.1
â”‚Â Â      â””â”€â”€ [118M]  SRR9693121.localhost.1507.0003.1
â”œâ”€â”€ [4.0K]  fastq_subset
â”‚Â Â  â””â”€â”€ [ 14M]  SRR9693121_1_subset.fastq
â”œâ”€â”€ [4.0K]  mirbase_rno
â”‚Â Â  â””â”€â”€ [   0]  rno_mature.fa
â”œâ”€â”€ [4.0K]  qc_reports
â”‚Â Â  â”œâ”€â”€ [804K]  SRR9693121_1_fastqc.html
â”‚Â Â  â”œâ”€â”€ [756K]  SRR9693121_1_fastqc.zip
â”‚Â Â  â”œâ”€â”€ [814K]  SRR9693121_1_trimmed_fastqc.html
â”‚Â Â  â”œâ”€â”€ [744K]  SRR9693121_1_trimmed_fastqc.zip
â”‚Â Â  â”œâ”€â”€ [4.0K]  TrimGalore-master
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ [ 22K]  CHANGELOG.md
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ [4.0K]  Docs
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ [ 34K]  LICENSE
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ [1.8K]  README.md
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ [4.0K]  test_files
â”‚Â Â  â”‚Â Â  â””â”€â”€ [139K]  trim_galore
â”‚Â Â  â””â”€â”€ [ 26M]  master.zip
â””â”€â”€ [4.0K]  reference
    â”œâ”€â”€ [2.7G]  GCA_036323735.1_GRCr8_genomic.fna
    â”œâ”€â”€ [3.6K]  GCA_036323735.1_GRCr8_genomic.fna.amb
    â”œâ”€â”€ [ 10K]  GCA_036323735.1_GRCr8_genomic.fna.ann
    â”œâ”€â”€ [2.7G]  GCA_036323735.1_GRCr8_genomic.fna.bwt
    â”œâ”€â”€ [679M]  GCA_036323735.1_GRCr8_genomic.fna.pac
    â”œâ”€â”€ [1.3G]  GCA_036323735.1_GRCr8_genomic.fna.sa
    â”œâ”€â”€ [840M]  GCF_036323735.1_GRCr8_genomic.gtf
    â”œâ”€â”€ [2.9G]  Homo_sapiens.GRCh38.dna.primary_assembly.fa
    â”œâ”€â”€ [ 18K]  Homo_sapiens.GRCh38.dna.primary_assembly.fa.amb
    â”œâ”€â”€ [ 16K]  Homo_sapiens.GRCh38.dna.primary_assembly.fa.ann
    â”œâ”€â”€ [2.9G]  Homo_sapiens.GRCh38.dna.primary_assembly.fa.bwt
    â”œâ”€â”€ [739M]  Homo_sapiens.GRCh38.dna.primary_assembly.fa.pac
    â”œâ”€â”€ [1.4G]  Homo_sapiens.GRCh38.dna.primary_assembly.fa.sa
    â”œâ”€â”€ [996K]  aligned.bam
    â”œâ”€â”€ [ 15M]  aligned.sam
    â”œâ”€â”€ [991K]  aligned.sorted.bam
    â”œâ”€â”€ [114K]  aligned.sorted.bam.bai
    â”œâ”€â”€ [159M]  aligned_fastp.bam
    â”œâ”€â”€ [3.4G]  aligned_fastp.sam
    â”œâ”€â”€ [158M]  aligned_fastp.sorted.bam
    â”œâ”€â”€ [122K]  aligned_fastp.sorted.bam.bai
    â”œâ”€â”€ [163M]  aligned_full.bam
    â”œâ”€â”€ [3.4G]  aligned_full.sam
    â”œâ”€â”€ [157M]  aligned_full.sorted.bam
    â”œâ”€â”€ [1.4M]  aligned_full.sorted.bam.bai
    â”œâ”€â”€ [165M]  aligned_rat.bam
    â”œâ”€â”€ [3.4G]  aligned_rat.sam
    â”œâ”€â”€ [157M]  aligned_rat.sorted.bam
    â”œâ”€â”€ [1.4M]  aligned_rat.sorted.bam.bai
    â”œâ”€â”€ [242M]  chr1.fa
    â”œâ”€â”€ [2.5K]  chr1.fa.amb
    â”œâ”€â”€ [  45]  chr1.fa.ann
    â”œâ”€â”€ [237M]  chr1.fa.bwt
    â”œâ”€â”€ [ 59M]  chr1.fa.pac
    â””â”€â”€ [119M]  chr1.fa.sa

13 directories, 60 files
```

## ğŸ§  ä¸ºä»€ä¹ˆ Cç›˜è¿˜å ç©ºé—´ï¼Ÿ

WSL ä½¿ç”¨ä¸€ä¸ªè™šæ‹Ÿç£ç›˜æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ `.vhdx`ï¼‰æ¥å­˜å‚¨ Linux å­ç³»ç»Ÿçš„æ•°æ®ã€‚å³ä½¿ä½ åœ¨ WSL ä¸­åˆ é™¤äº†æ–‡ä»¶ï¼Œ**ç©ºé—´ä¸ä¼šè‡ªåŠ¨é‡Šæ”¾**ï¼Œé™¤éä½ æ‰‹åŠ¨å‹ç¼©è¿™ä¸ªè™šæ‹Ÿç£ç›˜ã€‚

### ğŸ“ æ­¥éª¤ï¼š

1.  æ‰“å¼€ PowerShellï¼ˆç®¡ç†å‘˜ï¼‰

2.  è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š

powershell

```         
diskpart 
```

ç„¶ååœ¨ `diskpart>` æç¤ºç¬¦ä¸‹ä¾æ¬¡è¾“å…¥ï¼š

text

```         
select vdisk file="C:\Users\31435\AppData\Local\wsl\{49e678dd-1912-4b46-8d2e-2022839de267}\ext4.vhdx" 
attach vdisk readonly
compact vdisk 
detach vdisk 
exit 
```

> âš ï¸ æ³¨æ„ï¼šç¡®ä¿ WSL å·²å…³é—­ï¼ˆè¿è¡Œ `wsl --shutdown`ï¼‰

-   âœ… æˆåŠŸé€‰æ‹© `.vhdx` æ–‡ä»¶

-   âœ… åªè¯»æŒ‚è½½

-   âœ… å®Œæ•´å‹ç¼©

-   âœ… å®‰å…¨å¸è½½

è¿™æ„å‘³ç€ä½ åœ¨ WSL ä¸­åˆ é™¤çš„é‚£äº›å¤§æ–‡ä»¶ï¼ˆæ¯”å¦‚å‚è€ƒåŸºå› ç»„ã€åŸå§‹ FASTQ ç­‰ï¼‰ç°åœ¨å·²ç»çœŸæ­£ä» C ç›˜é‡Šæ”¾å‡ºæ¥äº†ã€‚ä½ çš„ç³»ç»Ÿç©ºé—´åº”è¯¥æ˜æ˜¾å›å‡ï¼ŒWSL è™šæ‹Ÿç£ç›˜ä¹Ÿå˜å¾—æ›´è½»ç›ˆã€‚

## ğŸ”š é¡¹ç›®æ¸…ç†å®Œæˆï¼Œä½ ç°åœ¨çš„çŠ¶æ€ï¼š

-   WSL é¡¹ç›®ç›®å½•å¹²å‡€æ•´æ´

-   åªä¿ç•™å…³é”®ç»“æœæ–‡ä»¶ï¼ˆå¦‚ `.bam.bai`ï¼‰

-   è™šæ‹Ÿç£ç›˜å·²å‹ç¼©ï¼Œé‡Šæ”¾äº†æ•° GB ç©ºé—´

-   æ²¡æœ‰è¯¯åˆ ä»»ä½•é‡è¦æ•°æ®