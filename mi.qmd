## ğŸ§¬ æ•°æ®æ¦‚è§ˆï¼šSRX30029406

### ğŸ“Œ æ ·æœ¬ä¿¡æ¯

-   **æ ·æœ¬ç±»å‹**ï¼šUlcerative colitisï¼ˆæºƒç–¡æ€§ç»“è‚ ç‚ï¼‰

-   **ç‰©ç§**ï¼šHomo sapiensï¼ˆäººç±»ï¼‰

-   **æ ·æœ¬ç¼–å·**ï¼šSAMN50490031 / SRS26099950

-   **æ–‡åº“åç§°**ï¼šC018

-   **æ¥æºç±»å‹**ï¼šOTHERï¼ˆéæ ‡å‡†ç»„ç»‡æˆ–ç»†èƒç³»ï¼Œå¯èƒ½æ˜¯è¡€æ¶²æˆ–è¡€æµ†ï¼‰

-   **é€‰æ‹©æ–¹å¼**ï¼šPCRï¼ˆè¯´æ˜æœ‰æ‰©å¢æ­¥éª¤ï¼Œå¯èƒ½å½±å“å®šé‡åå€šï¼‰

### ğŸ§ª å®éªŒè®¾è®¡

-   **å»ºåº“è¯•å‰‚ç›’**ï¼šNEBNext Small RNA Library Prep Setï¼ˆIlluminaå¹³å°ä¸“ç”¨ï¼‰

-   **å»ºåº“æµç¨‹**ï¼š

    -   æ¯ä¸ªæ ·æœ¬ç­‰é‡æ··åˆæˆä¸€ä¸ªæ–‡åº“ï¼ˆè¯´æ˜è¿™æ˜¯ pooled libraryï¼Œå¯èƒ½æ— æ³•åŒºåˆ†æ ·æœ¬ï¼‰

    -   æ–‡åº“æµ“åº¦è°ƒæ•´è‡³ 4 nMï¼Œä½¿ç”¨ Tris ç¼“å†²æ¶²ï¼ˆpH 8.5ï¼‰

    -   ä½¿ç”¨ 0.2 N NaOH å˜æ€§

    -   åŠ å…¥ 1% PhiX æ§åˆ¶æ–‡åº“ä½œä¸ºå†…å‚ï¼ˆç”¨äºæµ‹åºè´¨é‡æ§åˆ¶ï¼‰

### ğŸ§¬ æµ‹åºä¿¡æ¯

-   **å¹³å°**ï¼šIllumina NextSeq 550

-   **æµ‹åºç±»å‹**ï¼šå•ç«¯ï¼ˆSINGLEï¼‰

-   **ç­–ç•¥**ï¼šmiRNA-Seq

-   **è¯»é•¿**ï¼š75 bpï¼ˆè¿œå¤§äºå…¸å‹ miRNA é•¿åº¦ï¼Œè¯´æ˜åŒ…å«é€‚é…å­åºåˆ—ï¼‰

-   **æ•°æ®é‡**ï¼š

    -   1 æ¬¡è¿è¡Œï¼ˆRunï¼‰

    -   1.34M readsï¼ˆspotsï¼‰

    -   67.1M bases

    -   æ–‡ä»¶å¤§å°çº¦ 27.7Mb

## ğŸ” æ•°æ®ç‰¹ç‚¹ä¸åˆ†æé‡ç‚¹

### 1. **é€‚é…å­æ±¡æŸ“å¯èƒ½æ€§é«˜**

-   ç”±äºè¯»é•¿ä¸º 75 bpï¼Œè€Œ miRNA é€šå¸¸åªæœ‰ 18â€“24 ntï¼Œè¯´æ˜åºåˆ—ä¸­å¯èƒ½åŒ…å«è¾ƒé•¿çš„ 3' é€‚é…å­ã€‚

-   NEBNext çš„å¸¸è§é€‚é…å­åºåˆ—ä¸ºï¼š

    ä»£ç 

    ```         
    AGATCGGAAGAGCACACGTCT 
    ```

-   åç»­éœ€é‡ç‚¹è¿›è¡Œé€‚é…å­å»é™¤å’Œé•¿åº¦è¿‡æ»¤ã€‚

### 2. **æ ·æœ¬æ··åˆï¼ˆpooledï¼‰è®¾è®¡**

-   æ¯ä¸ªæ ·æœ¬ç­‰é‡æ··åˆè¿›ä¸€ä¸ªæ–‡åº“ï¼Œæ„å‘³ç€ï¼š

    -   æ— æ³•è¿›è¡Œä¸ªä½“å±‚é¢çš„å·®å¼‚è¡¨è¾¾åˆ†æ

    -   æ›´é€‚åˆåšæ€»ä½“è¡¨è¾¾è°±æˆ–æ¢ç´¢æ€§åˆ†æ

    -   è‹¥åç»­æœ‰å¤šä¸ª SRX/SRR æ–‡ä»¶ï¼Œéœ€ç¡®è®¤æ˜¯å¦æ¯ä¸ªä»£è¡¨ä¸€ä¸ª pooled group

### 3. **æµ‹åºæ·±åº¦é€‚ä¸­**

-   çº¦ 1.3M readsï¼Œå±äºä¸­ç­‰æ·±åº¦çš„ miRNA-Seq

-   è¶³ä»¥æ£€æµ‹é«˜è¡¨è¾¾ miRNAï¼Œä½†å¯¹ä½ä¸°åº¦ miRNA çš„çµæ•åº¦æœ‰é™

-   åç»­å¯è¯„ä¼° mapping rate å’Œè¡¨è¾¾åˆ†å¸ƒï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ·±æµ‹åºæˆ–è¡¥å……æ ·æœ¬

### 4. **ç ”ç©¶èƒŒæ™¯**

-   ç ”ç©¶ç›®æ ‡æ˜¯æ¢ç´¢æœªæ²»ç–—çš„ IBDï¼ˆCrohn å’Œ UCï¼‰æ‚£è€…ä¸­ï¼Œå…ç–«ç³»ç»Ÿå¤±è°ƒä¸è¡€æºæ€§ miRNA çš„å…³ç³»

-   è¿™æç¤ºæˆ‘ä»¬åç»­åˆ†æå¯ä»¥å…³æ³¨ï¼š

    -   è¡€æ¶²ä¸­é«˜è¡¨è¾¾çš„ miRNAï¼ˆå¦‚ miR-21, miR-146a ç­‰ï¼‰

    -   ä¸ç‚ç—‡ã€å…ç–«è°ƒèŠ‚ç›¸å…³çš„ miRNA

    -   æ˜¯å¦æœ‰å·²çŸ¥ IBD biomarker miRNA è¡¨è¾¾å¼‚å¸¸

## ğŸ“¥ ç¬¬ä¸€æ­¥ï¼šä¸‹è½½ SRR34901102 çš„ FASTQ æ•°æ®

å·²å®‰è£… SRA Toolkitï¼Œå¹¶é…ç½®å¥½ `vdb-config`ã€‚

### ğŸ”§ ä¸‹è½½å¹¶è½¬æ¢ä¸º FASTQ æ ¼å¼

``` bash
# ä¸‹è½½ SRA æ–‡ä»¶
prefetch SRR34901102

# è½¬æ¢ä¸º FASTQï¼ˆå•ç«¯æ•°æ®ï¼‰
fasterq-dump SRR34901102 -e 8 -O fastq/
```

-   `-e 8`ï¼šä½¿ç”¨ 8 ä¸ªçº¿ç¨‹åŠ é€Ÿ

-   `-O fastq/`ï¼šè¾“å‡ºåˆ°æŒ‡å®šç›®å½•

``` bash
^Cjayz@localhost:~/miRNA/data/data# ä¸‹è½½ SRA æ–‡ä»¶ä»¶
prefetch SRR34901102

# è½¬æ¢ä¸º FASTQï¼ˆå•ç«¯æ•°æ®ï¼‰
fasterq-dump SRR34901102 -e 8 -O fastq/

2025-10-23T02:23:25 prefetch.3.0.3: Current preference is set to retrieve SRA Normalized Format files with full base quality scores.
2025-10-23T02:23:26 prefetch.3.0.3: 1) Downloading 'SRR34901102'...
2025-10-23T02:23:26 prefetch.3.0.3: SRA Normalized Format file is being retrieved, if this is different from your preference, it may be due to current file availability.
2025-10-23T02:23:26 prefetch.3.0.3:  Downloading via HTTPS...
2025-10-23T02:23:26 prefetch.3.0.3:    Continue download of 'SRR34901102' from 573945      
2025-10-23T02:23:47 prefetch.3.0.3:  HTTPS download succeed
2025-10-23T02:23:47 prefetch.3.0.3:  'SRR34901102' is valid
2025-10-23T02:23:47 prefetch.3.0.3: 1) 'SRR34901102' was downloaded successfully
2025-10-23T02:23:47 prefetch.3.0.3: 'SRR34901102' has 0 unresolved dependencies
spots read      : 1,342,171
reads read      : 1,342,171
reads written   : 1,342,171
```

å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤ç¡®è®¤æ–‡ä»¶å¤§å°ï¼Œå¾—åˆ°316M

```         
ls -lh fastq/SRR34901102.fastq 
```

``` bash
jayz@localhost:~/miRNA/data/data$ ls -lh fastq/SRR34901102.fastq 
-rw-r--r-- 1 jayz jayz 316M Oct 23 10:23 fastq/SRR34901102.fastq
```

## ğŸ” ç¬¬äºŒæ­¥ï¼šè¿è¡Œ FastQC è¿›è¡Œè´¨é‡è¯„ä¼°

å·²å®‰è£… FastQCï¼Œç„¶åè¿è¡Œï¼š

``` bash
# åˆ›å»ºè¾“å‡ºç›®å½•
mkdir -p fastqc_output

# è¿è¡Œ FastQC
fastqc fastq/SRR34901102.fastq -o fastqc_output/
```

FastQC ä¼šç”Ÿæˆä¸€ä¸ª `.html` æŠ¥å‘Šå’Œ `.zip` æ–‡ä»¶ã€‚ä½ å¯ä»¥ç”¨æµè§ˆå™¨æ‰“å¼€ HTML æ–‡ä»¶æŸ¥çœ‹å›¾å½¢åŒ–ç»“æœã€‚

``` bash
jayz@localhost:~/miRNA/data/data$ # åˆ›å»ºè¾“å‡ºç›®å½•
mkdir -p fastqc_output

# è¿è¡Œ FastQC
fastqc fastq/SRR34901102.fastq -o fastqc_output/
null
Started analysis of SRR34901102.fastq
Approx 5% complete for SRR34901102.fastq
Approx 10% complete for SRR34901102.fastq
Approx 15% complete for SRR34901102.fastq
Approx 20% complete for SRR34901102.fastq
Approx 25% complete for SRR34901102.fastq
Approx 30% complete for SRR34901102.fastq
Approx 35% complete for SRR34901102.fastq
Approx 40% complete for SRR34901102.fastq
Approx 45% complete for SRR34901102.fastq
Approx 50% complete for SRR34901102.fastq
Approx 55% complete for SRR34901102.fastq
Approx 60% complete for SRR34901102.fastq
Approx 65% complete for SRR34901102.fastq
Approx 70% complete for SRR34901102.fastq
Approx 75% complete for SRR34901102.fastq
Approx 80% complete for SRR34901102.fastq
Approx 85% complete for SRR34901102.fastq
Approx 90% complete for SRR34901102.fastq
Approx 95% complete for SRR34901102.fastq
Analysis complete for SRR34901102.fastq
```

![](images/å±å¹•æˆªå›¾%202025-10-23%20102721.png)

![](images/å±å¹•æˆªå›¾%202025-10-23%20102737.png)

![](images/å±å¹•æˆªå›¾%202025-10-23%20102746.png)

![](images/å±å¹•æˆªå›¾%202025-10-23%20102753.png)

![](images/å±å¹•æˆªå›¾%202025-10-23%20102802.png)

![](images/å±å¹•æˆªå›¾%202025-10-23%20102810.png)

## âœ… åœ¨ miRNA-Seq ä¸­å¸¸è§çš„çº¢å‰æ¨¡å—è§£é‡Š

| æ¨¡å—åç§° | FastQC çº¢å‰åŸå›  | åœ¨ miRNA-Seq ä¸­æ˜¯å¦å¼‚å¸¸ | è§£é‡Š |
|------------------|------------------|------------------|------------------|
| **Per base sequence content** | æ¯ä¸ªä½ç‚¹çš„ A/T/G/C æ¯”ä¾‹ä¸å‡è¡¡ | âœ… æ­£å¸¸ | miRNA åºåˆ—æ˜¯é«˜åº¦ç»“æ„åŒ–çš„çŸ­åºåˆ—ï¼Œå‰å‡ ä½å¸¸å¸¸æœ‰åå¥½æ€§ï¼ˆå¦‚ seed åŒºåŸŸï¼‰ï¼Œå¯¼è‡´ç¢±åŸºæ¯”ä¾‹ä¸å‡è¡¡ |
| **GC content** | GC å«é‡åç¦»ç†è®ºåˆ†å¸ƒ | âœ… æ­£å¸¸ | miRNA é€šå¸¸ GC å«é‡åé«˜ï¼Œå°¤å…¶æ˜¯æŸäº›ç‚ç—‡ç›¸å…³ miRNAï¼ˆå¦‚ miR-21ï¼‰ï¼Œåç¦»å‡å€¼æ˜¯é¢„æœŸçš„ |
| **Sequence duplication levels** | åºåˆ—é‡å¤ç‡é«˜ | âœ… æ­£å¸¸ | miRNA è¡¨è¾¾æœ¬èº«å°±é«˜åº¦é›†ä¸­ï¼Œå‡ ä¸ªé«˜è¡¨è¾¾ miRNA å æ®å¤§éƒ¨åˆ† readsï¼Œé‡å¤ç‡é«˜æ˜¯ç”Ÿç‰©å­¦ç‰¹å¾ |
| **Overrepresented sequences** | æŸäº›åºåˆ—é¢‘ç‡è¿œé«˜äºèƒŒæ™¯ | âœ… æ­£å¸¸ | è¿™äº›å¾€å¾€æ˜¯ adapter åºåˆ—æˆ–é«˜è¡¨è¾¾ miRNAï¼ˆå¦‚ miR-16ã€miR-451ï¼‰ï¼ŒFastQC ä¼šæ ‡çº¢ä½†åœ¨ miRNA-Seq ä¸­æ˜¯é¢„æœŸç°è±¡ |

## ğŸ§  æ€»ç»“

è¿™äº›çº¢å‰åœ¨ **å¸¸è§„ RNA-Seq æˆ– WGS** ä¸­å¯èƒ½è¡¨ç¤ºé—®é¢˜ï¼Œä½†åœ¨ **miRNA-Seq** ä¸­å¾€å¾€æ˜¯ **ç”Ÿç‰©å­¦ç‰¹å¾** æˆ– **æŠ€æœ¯è®¾è®¡å¯¼è‡´çš„é¢„æœŸç°è±¡**ï¼Œå¹¶ä¸ä»£è¡¨æ•°æ®è´¨é‡å·®ã€‚

## âœ… å»é™¤adapterï¼ˆé’ˆå¯¹å•ç«¯ miRNA-Seqï¼‰

å¸¸è§ä¿¡æ¯ï¼š5' æ¥å¤´åºåˆ—å¾€å¾€ä»¥ AGATCGGAAGAGCACACGTCT å¼€å¤´çš„ç‰‡æ®µå‡ºç°åœ¨å¤šå®¶ä¾›åº”å•†å’Œç¤¾åŒºèµ„æ–™ä¸­ï¼Œä½œä¸º 5' ç«¯æ¥å¤´çš„èµ·å§‹åºåˆ—çš„ä¸€éƒ¨åˆ†ã€‚å…·ä½“å®Œæ•´åºåˆ—éœ€ä»¥ä½ å‹å·çš„å®˜æ–¹æ–‡æ¡£ä¸ºå‡†ï¼Œå› ä¸ºä¸åŒç‰ˆæœ¬å¯èƒ½åŒ…å«é¢å¤–çš„å¼•ç‰©åŒºåŸŸæˆ–å˜ä½“ã€‚æ­¤èµ·å§‹ç‰‡æ®µåœ¨è‹¥å¹²èµ„æ–™ä¸­è¢«å¼•ç”¨ä¸º NEBNext å°RNA æ–‡åº“æ¥å¤´çš„ä¸€éƒ¨åˆ†

``` bash
fastp -i SRR34901102.fastq -o trimmed.fastq \
      -j fastp.json -h fastp.html \
      --detect_adapter_for_pe 
```

### å‚æ•°è§£é‡Šï¼š

-   `-i`ï¼šè¾“å…¥åŸå§‹ FASTQ æ–‡ä»¶ï¼ˆå•ç«¯ï¼‰

-   `-o`ï¼šè¾“å‡ºæ¸…æ´—åçš„ FASTQ æ–‡ä»¶

-   `-j`ï¼šè¾“å‡º JSON æ ¼å¼çš„è´¨æ§æŠ¥å‘Š

-   `-h`ï¼šè¾“å‡º HTML æ ¼å¼çš„è´¨æ§æŠ¥å‘Š

-   `--detect_adapter`ï¼šè‡ªåŠ¨æ£€æµ‹å¹¶å»é™¤é€‚é…å­ï¼ˆé€‚ç”¨äºå•ç«¯æ•°æ®ï¼‰

``` bash
jayz@localhost:~/miRNA/data/data/fastq$ fastp -i SRR34901102.fastq -o trimmed.fastq \
      -j fastp.json -h fastp.html \
      --detect_adapter_for_pe 
Detecting adapter sequence for read1...
CACCCTGAACGCGCCCGATCTCGTCTGATCTCGGAAGCTAAGCAGGGTCGGGCCTGGT

Read1 before filtering:
total reads: 1342171
total bases: 67108550
Q20 bases: 63379100(94.4427%)
Q30 bases: 61967498(92.3392%)

Read1 after filtering:
total reads: 1332198
total bases: 66606859
Q20 bases: 63054730(94.667%)
Q30 bases: 61670249(92.5884%)

Filtering result:
reads passed filter: 1332198
reads failed due to low quality: 7197
reads failed due to too many N: 1
reads failed due to too short: 2775
reads with adapter trimmed: 2981
bases trimmed due to adapters: 135802

Duplication rate (may be overestimated since this is SE data): 91.7063%

JSON report: fastp.json
HTML report: fastp.html

fastp -i SRR34901102.fastq -o trimmed.fastq -j fastp.json -h fastp.html --detect_adapter_for_pe
fastp v0.23.4, time used: 2 seconds
```

## ğŸ§¼ fastp æ¸…æ´—ç»“æœåˆ†æ

### ğŸ”¹ è‡ªåŠ¨æ£€æµ‹åˆ°çš„é€‚é…å­åºåˆ—

``` bash
CACCCTGAACGCGCCCGATCTCGTCTGATCTCGGAAGCTAAGCAGGGTCGGGCCTGGT 
```

-   è¿™ä¸ªåºåˆ—å¹¶ä¸æ˜¯ NEBNext å®˜æ–¹é€‚é…å­ï¼ˆé€šå¸¸æ˜¯ `AGATCGGAAGAGCACACGTCT`ï¼‰ï¼Œä½†å®ƒå¯èƒ½æ˜¯æ‹¼æ¥åçš„ adapter + insert çš„ä¸€éƒ¨åˆ†ã€‚

-   fastp è‡ªåŠ¨æ£€æµ‹æœºåˆ¶åœ¨ miRNA-Seq ä¸­æœ‰æ—¶ä¼šåç¦»çœŸå® adapterï¼Œå»ºè®®åç»­ç”¨ Cutadapt æ‰‹åŠ¨æŒ‡å®š adapter å†åšä¸€æ¬¡å¯¹æ¯”ã€‚

### ğŸ”¹ é‡å¤ç‡

``` bash
Duplication rate: 91.7% 
```

-   åœ¨ miRNA-Seq ä¸­è¿™æ˜¯**æ­£å¸¸ç°è±¡**ï¼Œå› ä¸ºé«˜è¡¨è¾¾ miRNAï¼ˆå¦‚ miR-16ã€miR-21ï¼‰ä¼šå æ®å¤§é‡ readsã€‚

-   FastQC å’Œ fastp éƒ½ä¼šæ ‡çº¢ï¼Œä½†è¿™ä¸æ˜¯æŠ€æœ¯é—®é¢˜ï¼Œè€Œæ˜¯ç”Ÿç‰©å­¦ç‰¹å¾ã€‚

## âœ‚ï¸ Cutadapt å‘½ä»¤è®¾è®¡ï¼ˆé’ˆå¯¹ SRR34901102ï¼‰

```         
cutadapt -a AGATCGGAAGAGCACACGTCT \
  -m 18 -M 30 \
  --discard-untrimmed \
  -o cutadapt_trimmed.fastq \
  trimmed.fastq
```

### å‚æ•°è§£é‡Šï¼š

-   `-a AGATCGGAAGAGCACACGTCT`ï¼šæŒ‡å®š NEBNext çš„ 3' é€‚é…å­åºåˆ—

-   `-m 18 -M 30`ï¼šä¿ç•™é•¿åº¦åœ¨ 18â€“30 nt çš„ readsï¼ˆå…¸å‹ miRNA èŒƒå›´ï¼‰

-   `--discard-untrimmed`ï¼šä¸¢å¼ƒæœªæ£€æµ‹åˆ°é€‚é…å­çš„ readsï¼ˆæ›´ä¸¥æ ¼ï¼Œç¡®ä¿åªä¿ç•™çœŸå® insertï¼‰

-   `-o cutadapt_trimmed.fastq`ï¼šè¾“å‡ºæ–‡ä»¶å

-   `trimmed.fastq`ï¼šè¾“å…¥æ–‡ä»¶ï¼ˆä½ åˆšç”¨ fastp ç”Ÿæˆçš„ï¼‰

``` bash
jayz@localhost:~/miRNA/data/data/fastq$ cutadapt -a AGATCGGAAGAGCACACGTCT \
  -m 18 -M 30 \
  --discard-untrimmed \
  -o cutadapt_trimmed.fastq \
  trimmed.fastq
This is cutadapt 4.4 with Python 3.12.3
Command line parameters: -a AGATCGGAAGAGCACACGTCT -m 18 -M 30 --discard-untrimmed -o cutadapt_trimmed.fastq trimmed.fastq
Processing single-end reads on 1 core ...
Done           00:00:02     1,332,198 reads @   1.9 Âµs/read;  32.13 M reads/minute
Finished in 2.490 s (1.869 Âµs/read; 32.11 M reads/minute).

=== Summary ===

Total reads processed:               1,332,198
Reads with adapters:                   608,832 (45.7%)

== Read fate breakdown ==
Reads that were too short:              83,709 (6.3%)
Reads that were too long:            1,149,748 (86.3%)
Reads discarded as untrimmed:               35 (0.0%)
Reads written (passing filters):        98,706 (7.4%)

Total basepairs processed:    66,606,859 bp
Total written (filtered):      2,200,894 bp (3.3%)

=== Adapter 1 ===

Sequence: AGATCGGAAGAGCACACGTCT; Type: regular 3'; Length: 21; Trimmed: 608832 times      

Minimum overlap: 3
No. of allowed errors:
1-9 bp: 0; 10-19 bp: 1; 20-21 bp: 2

Bases preceding removed adapters:
  A: 17.8%
  C: 13.7%
  G: 6.5%
  T: 56.7%
  none/other: 5.3%

Overview of removed sequences
length  count   expect  max.err error counts
3       3362    20815.6 0       3362
4       2556    5203.9  0       2556
5       17198   1301.0  0       17198
6       6924    325.2   0       6924
7       1858    81.3    0       1858
8       1844    20.3    0       1844
9       2605    5.1     0       2601 4
10      6374    1.3     1       6174 200
11      7680    0.3     1       7409 271
12      11608   0.1     1       11156 452
13      151995  0.0     1       146666 5329
14      45027   0.0     1       43204 1823
15      42817   0.0     1       40167 2650
16      13021   0.0     1       12316 705
17      38499   0.0     1       36578 1921
18      64471   0.0     1       61284 3169 18
19      8627    0.0     1       8130 488 9
20      3281    0.0     2       3050 202 29
21      2887    0.0     2       2638 216 33
22      2171    0.0     2       2007 144 20
23      1495    0.0     2       1371 111 13
24      1766    0.0     2       1632 110 24
25      1761    0.0     2       1606 139 16
26      3256    0.0     2       3005 216 35
27      14922   0.0     2       13750 1070 102
28      29900   0.0     2       28122 1600 178
29      18848   0.0     2       17590 1129 129
30      9090    0.0     2       8375 618 97
31      2842    0.0     2       2630 193 19
32      6478    0.0     2       5937 470 71
33      8357    0.0     2       7616 628 113
34      20017   0.0     2       18336 1466 215
35      5067    0.0     2       4659 368 40
36      2563    0.0     2       2365 178 20
37      1967    0.0     2       1810 142 15
38      1422    0.0     2       1298 113 11
39      1177    0.0     2       1071 96 10
40      825     0.0     2       747 69 9
41      7098    0.0     2       6540 514 44
42      445     0.0     2       406 33 6
43      298     0.0     2       269 27 2
44      343     0.0     2       324 19
45      417     0.0     2       386 27 4
46      276     0.0     2       259 14 3
47      395     0.0     2       346 44 5
48      317     0.0     2       288 26 3
49      482     0.0     2       449 31 2
50      32203   0.0     2       29495 2463 245
```

è¿‡é•¿çš„ reads æ¯”ä¾‹å¼‚å¸¸é«˜ï¼ˆ86.3%ï¼‰

## ğŸ§  ä¸ºä»€ä¹ˆ adapter å¯èƒ½ä¸æ˜¯æ ‡å‡†åºåˆ—ï¼Ÿ

1.  **NEBNext çš„ adapter æ˜¯å¯å˜ç»“æ„**ï¼š

    -   è™½ç„¶æ–‡æ¡£ä¸­å†™çš„æ˜¯ `AGATCGGAAGAGCACACGTCT`ï¼Œä½†å®é™…æµ‹åºä¸­å¯èƒ½æ˜¯ adapter + barcode + linker çš„ç»„åˆã€‚

    -   çœŸå®æ±¡æŸ“åºåˆ—å¯èƒ½æ›´é•¿ã€æ›´å¤æ‚ï¼Œæˆ–æœ‰å˜ä½“ã€‚

2.  **FastQC ä¸­çš„ Overrepresented Sequences æç¤ºçœŸå® adapter**ï¼š

    -   ä¹‹å‰ç”¨ fastp è‡ªåŠ¨æ£€æµ‹åˆ°çš„åºåˆ—æ˜¯ï¼š

        ```         
        CACCCTGAACGCGCCCGATCTCGTCTGATCTCGGAAGCTAAGCAGGGTCGGGCCTGGT 
        ```

    -   è¿™å¯èƒ½æ˜¯ adapter çš„çœŸå®æ±¡æŸ“å½¢å¼ï¼ŒåŒ…å«äº† barcode æˆ– linker åŒºåŸŸã€‚

3.  **Cutadapt åªè¯†åˆ«æ ‡å‡† adapterï¼Œå¯èƒ½æ¼æ‰çœŸå®æ±¡æŸ“åºåˆ—**ï¼š

    -   è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆåªæœ‰ 45.7% çš„ reads è¢«è¯†åˆ«ä¸ºå« adapterï¼Œè€Œå‰©ä¸‹çš„ 86.3% è¢«åˆ¤å®šä¸ºâ€œè¿‡é•¿â€ã€‚

## ç”¨çœŸå® adapter å†è·‘ä¸€æ¬¡ Cutadapt

å¯ä»¥å°è¯•ç”¨ fastp æ£€æµ‹åˆ°çš„åºåˆ—ä½œä¸º adapterï¼Œé‡æ–°è·‘ Cutadaptï¼š

``` bash
cutadapt -a CACCCTGAACGCGCCCGATCTCGTCTGATCTCGGAAGCTAAGCAGGGTCGGGCCTGGT \
  -m 15 -M 40 \
  --discard-untrimmed \
  -o cutadapt_final.fastq \
  SRR34901102.fastq
```

``` bash
jayz@localhost:~/miRNA/data/data/fastq$ cutadapt -a CACCCTGAACGCGCCCGATCTCGTCTGATCTCGGAAGCTAAGCAGGGTCGGGCCTGGT \
  -m 18 -M 30 \
  --discard-untrimmed \
  -o cutadapt_realadapter.fastq \
  trimmed.fastq
This is cutadapt 4.4 with Python 3.12.3
Command line parameters: -a CACCCTGAACGCGCCCGATCTCGTCTGATCTCGGAAGCTAAGCAGGGTCGGGCCTGGT -m 18 -M 30 --discard-untrimmed -o cutadapt_realadapter.fastq trimmed.fastq
Processing single-end reads on 1 core ...
Done           00:00:03     1,332,198 reads @   2.3 Âµs/read;  26.28 M reads/minute
Finished in 3.043 s (2.284 Âµs/read; 26.27 M reads/minute).

=== Summary ===

Total reads processed:               1,332,198
Reads with adapters:                   495,941 (37.2%)

== Read fate breakdown ==
Reads that were too short:             312,336 (23.4%)
Reads that were too long:            1,019,827 (76.6%)
Reads discarded as untrimmed:               35 (0.0%)
Reads written (passing filters):             0 (0.0%)

Total basepairs processed:    66,606,859 bp
Total written (filtered):              0 bp (0.0%)

=== Adapter 1 ===

Sequence: CACCCTGAACGCGCCCGATCTCGTCTGATCTCGGAAGCTAAGCAGGGTCGGGCCTGGT; Type: regular 3'; Length: 58; Trimmed: 495941 times

Minimum overlap: 3
No. of allowed errors:
1-9 bp: 0; 10-19 bp: 1; 20-29 bp: 2; 30-39 bp: 3; 40-49 bp: 4; 50-58 bp: 5

Bases preceding removed adapters:
  A: 8.1%
  C: 0.2%
  G: 8.4%
  T: 20.4%
  none/other: 63.0%

Overview of removed sequences
length  count   expect  max.err error counts
3       182460  20815.6 0       182460
4       1179    5203.9  0       1179
11      1       0.3     1       0 1
36      98      0.0     3       0 1 0 97
39      3       0.0     3       0 0 0 3
50      312200  0.0     5       0 0 0 0 1 312199
```

åˆ†æå¾—åˆ°

``` bash
#ç”¨CACCCTGAACGCGCCCGATCTCGTCTGATCTCGGAAGCTAAGCAGGGTCGGGCCTGGT
Total reads processed:               1,332,198
Reads with adapters:                   495,941 (37.2%)
```

``` bash
#ç”¨AGATCGGAAGAGCACACGTCT
Total reads processed:               1,332,198
Reads with adapters:                   608,832 (45.7%)
```

#### ç”¨AGATCGGAAGAGCACACGTCT æ”¾å®½å¤§å°

``` bash
cutadapt -a AGATCGGAAGAGCACACGTCT \
  -m 18 -M 40 \
  --discard-untrimmed \
  -o cutadapt_trimmed.fastq \
  trimmed.fastq
```

``` bash
jayz@localhost:~/miRNA/data/data/fastq$ cutadapt -a AGATCGGAAGAGCACACGTCT \
  -m 18 -M 40 \
  --discard-untrimmed \
  -o cutadapt_trimmed.fastq \
  trimmed.fastq
This is cutadapt 4.4 with Python 3.12.3
Command line parameters: -a AGATCGGAAGAGCACACGTCT -m 18 -M 40 --discard-untrimmed -o cutadapt_trimmed.fastq trimmed.fastq
Processing single-end reads on 1 core ...
Done           00:00:02     1,332,198 reads @   2.0 Âµs/read;  29.67 M reads/minute
Finished in 2.702 s (2.028 Âµs/read; 29.58 M reads/minute).

=== Summary ===

Total reads processed:               1,332,198
Reads with adapters:                   608,832 (45.7%)

== Read fate breakdown ==
Reads that were too short:              83,709 (6.3%)
Reads that were too long:              759,642 (57.0%)
Reads discarded as untrimmed:               36 (0.0%)
Reads written (passing filters):       488,811 (36.7%)

Total basepairs processed:    66,606,859 bp
Total written (filtered):     15,983,004 bp (24.0%)

=== Adapter 1 ===

Sequence: AGATCGGAAGAGCACACGTCT; Type: regular 3'; Length: 21; Trimmed: 608832 times      

Minimum overlap: 3
No. of allowed errors:
1-9 bp: 0; 10-19 bp: 1; 20-21 bp: 2

Bases preceding removed adapters:
  A: 17.8%
  C: 13.7%
  G: 6.5%
  T: 56.7%
  none/other: 5.3%

Overview of removed sequences
length  count   expect  max.err error counts
3       3362    20815.6 0       3362
4       2556    5203.9  0       2556
5       17198   1301.0  0       17198
6       6924    325.2   0       6924
7       1858    81.3    0       1858
8       1844    20.3    0       1844
9       2605    5.1     0       2601 4
10      6374    1.3     1       6174 200
11      7680    0.3     1       7409 271
12      11608   0.1     1       11156 452
13      151995  0.0     1       146666 5329
14      45027   0.0     1       43204 1823
15      42817   0.0     1       40167 2650
16      13021   0.0     1       12316 705
17      38499   0.0     1       36578 1921
18      64471   0.0     1       61284 3169 18
19      8627    0.0     1       8130 488 9
20      3281    0.0     2       3050 202 29
21      2887    0.0     2       2638 216 33
22      2171    0.0     2       2007 144 20
23      1495    0.0     2       1371 111 13
24      1766    0.0     2       1632 110 24
25      1761    0.0     2       1606 139 16
26      3256    0.0     2       3005 216 35
27      14922   0.0     2       13750 1070 102
28      29900   0.0     2       28122 1600 178
29      18848   0.0     2       17590 1129 129
30      9090    0.0     2       8375 618 97
31      2842    0.0     2       2630 193 19
32      6478    0.0     2       5937 470 71
33      8357    0.0     2       7616 628 113
34      20017   0.0     2       18336 1466 215
35      5067    0.0     2       4659 368 40
36      2563    0.0     2       2365 178 20
37      1967    0.0     2       1810 142 15
38      1422    0.0     2       1298 113 11
39      1177    0.0     2       1071 96 10
40      825     0.0     2       747 69 9
41      7098    0.0     2       6540 514 44
42      445     0.0     2       406 33 6
43      298     0.0     2       269 27 2
44      343     0.0     2       324 19
45      417     0.0     2       386 27 4
46      276     0.0     2       259 14 3
47      395     0.0     2       346 44 5
48      317     0.0     2       288 26 3
49      482     0.0     2       449 31 2
50      32203   0.0     2       29495 2463 245
```

## âœ… å½“å‰æ¸…æ´—ç»“æœæ€»ç»“

| é¡¹ç›®           | æ•°å€¼             | è¯´æ˜                            |
|----------------|------------------|---------------------------------|
| æ€» reads       | 1,332,198        | åŸå§‹è¾“å…¥                        |
| æ£€æµ‹åˆ° adapter | 608,832ï¼ˆ45.7%ï¼‰ | è¯´æ˜è¯¥ adapter æ˜¯ä¸»è¦æ±¡æŸ“æº     |
| é€šè¿‡è¿‡æ»¤ä¿ç•™   | 488,811ï¼ˆ36.7%ï¼‰ | éå¸¸ç†æƒ³ï¼Œé€‚åˆè¿›å…¥å®šé‡åˆ†æ      |
| ä¸¢å¼ƒè¿‡çŸ­ reads | 83,709ï¼ˆ6.3%ï¼‰   | å¤šä¸º adapter-only æˆ–é™è§£ç‰‡æ®µ    |
| ä¸¢å¼ƒè¿‡é•¿ reads | 759,642ï¼ˆ57.0%ï¼‰ | å¤šä¸ºæœªå®Œå…¨ä¿®å‰ªæˆ–é miRNA insert |

## ğŸ§  ç»“è®º

-   **AGATCGGAAGAGCACACGTCT æ˜¯è¿™æ‰¹æ•°æ®ä¸­æœ€æœ‰æ•ˆçš„ adapter åºåˆ—**ï¼Œæ¯” fastp è‡ªåŠ¨æ£€æµ‹çš„é‚£æ¡æ›´èƒ½è§£é‡Šæ±¡æŸ“æ¥æºã€‚

-   **cutadapt_trimmed.fastq æ˜¯ç›®å‰è€Œè¨€æœ€å¹²å‡€ã€æœ€é€‚åˆç”¨äºä¸‹æ¸¸åˆ†æçš„æ–‡ä»¶**ã€‚

-   å·²ç»å®Œæˆäº† miRNA-Seq ä¸Šæ¸¸æµç¨‹ä¸­æœ€å…³é”®çš„ä¸€æ­¥ï¼š**é«˜è´¨é‡çš„ adapter å»é™¤ + insert é•¿åº¦è¿‡æ»¤**ã€‚

## ğŸ§© æ­¥éª¤ 1ï¼šä½¿ç”¨ Bowtie æ¯”å¯¹åˆ° GRCh38 genome

å·²ç»æœ‰ GRCh38 çš„ Bowtie indexï¼ˆ`GRCh38_index.*.ebwt`ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ¯”å¯¹ï¼š

``` bash
bowtie -a --best --strata -v 2 -p 8 -S GRCh38_index \
  ~/miRNA/data/data/fastq/trimmed.fastq > aligned1_relaxed.sam
```

### å‚æ•°è¯´æ˜ï¼š

-   `-v 2`ï¼šå…è®¸æœ€å¤š 2 ä¸ª mismatchï¼ˆé€‚åˆçŸ­åºåˆ—ï¼‰

-   `-p 8`ï¼šä½¿ç”¨ 8 ä¸ªçº¿ç¨‹

-   `-S`ï¼šè¾“å‡º SAM æ ¼å¼

-   `GRCh38_index`ï¼š genome index å‰ç¼€

-   `trimmed.fastq`ï¼šä½ æ¸…æ´—åçš„ miRNA reads

``` bash
jayz@localhost:~/miRNA/data$ bowtie -a --best --strata -v 2 -p 8 -S GRCh38_index \
  ~/miRNA/data/data/fastq/trimmed.fastq > aligned1_relaxed.sam
Setting the index via positional argument will be deprecated in a future release. Please use -x option instead.
# reads processed: 1332198
# reads with at least one alignment: 712711 (53.50%)
# reads that failed to align: 619487 (46.50%)
Reported 12457063 alignments
```

## âœ… Bowtie æ¯”å¯¹ç»“æœæ€»ç»“

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------------------------|------------------------|------------------------|
| æ€» reads | 1,332,198 | æ¸…æ´—åçš„ miRNA reads |
| æˆåŠŸæ¯”å¯¹ | 683,871ï¼ˆ53.50%ï¼‰ | éå¸¸åˆç†ï¼Œè¯´æ˜æ•°æ®è´¨é‡è‰¯å¥½ |
| æœªæ¯”å¯¹ | 648,327ï¼ˆ46.50%ï¼‰ | å¯èƒ½æ˜¯ adapter-onlyã€é™è§£ç‰‡æ®µæˆ–é genome åŒ¹é…åºåˆ— |
| æ¯”å¯¹æ–¹å¼ | `-v 2`ï¼ˆå…è®¸ 1 ä¸ª mismatchï¼‰ | é€‚åˆçŸ­åºåˆ—ï¼Œå…¼é¡¾çµæ•åº¦ä¸ç‰¹å¼‚æ€§ |

## ğŸ§© æ­¥éª¤ 2ï¼šè½¬æ¢ä¸º BAM å¹¶æ’åº

``` bash
samtools view -bS aligned1_relaxed.sam > aligned1_relaxed.bam
samtools sort aligned1_relaxed.bam -o aligned1_relaxed.sorted.bam
samtools index aligned1_relaxed.sorted.bam
```

## ğŸ§© æ­¥éª¤ 3ï¼šä½¿ç”¨ featureCounts è¿›è¡Œå®šé‡

ä½ å·²ç»æœ‰ `hsa.gff3` æ³¨é‡Šæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿è¡Œï¼š

``` bash
featureCounts -T 8 -t miRNA -g Name \
  -a hsa.gff3 -o counts_mature_relaxed.txt aligned1_relaxed.sorted.bam
```

### å‚æ•°è¯´æ˜ï¼š

-   `-T 8`ï¼šä½¿ç”¨ 8 ä¸ªçº¿ç¨‹

-   `-t miRNA`ï¼šæ³¨é‡Šæ–‡ä»¶ä¸­ç”¨äºè®¡æ•°çš„ feature ç±»å‹ï¼ˆä½ å¯ä»¥å…ˆæ£€æŸ¥ GFF æ–‡ä»¶æ˜¯å¦ä½¿ç”¨ `miRNA`ã€`miRNA_primary_transcript` æˆ–å…¶ä»–ï¼‰

-   `-g ID`ï¼šç”¨äºåˆ†ç»„çš„å±æ€§å­—æ®µï¼ˆé€šå¸¸æ˜¯ miRNA IDï¼‰

-   `-a hsa.gff3`ï¼šæ³¨é‡Šæ–‡ä»¶

-   `-o counts.txt`ï¼šè¾“å‡ºè®¡æ•°ç»“æœ

``` bash
jayz@localhost:~/miRNA/data$ featureCounts -T 8 -t miRNA -g Name \
  -a hsa.gff3 -o counts_mature_relaxed.txt aligned1_relaxed.sorted.bam

        ==========     _____ _    _ ____  _____  ______          _____
        =====         / ____| |  | |  _ \|  __ \|  ____|   /\   |  __ \
          =====      | (___ | |  | | |_) | |__) | |__     /  \  | |  | |
            ====      \___ \| |  | |  _ <|  _  /|  __|   / /\ \ | |  | |
              ====    ____) | |__| | |_) | | \ \| |____ / ____ \| |__| |
        ==========   |_____/ \____/|____/|_|  \_\______/_/    \_\_____/
          v2.0.3

//========================== featureCounts setting ===========================\\
||                                                                            ||
||             Input files : 1 BAM file                                       ||
||                                                                            ||
||                           aligned1_relaxed.sorted.bam                      ||
||                                                                            ||
||             Output file : counts_mature_relaxed.txt                        ||
||                 Summary : counts_mature_relaxed.txt.summary                ||
||              Paired-end : no                                               ||
||        Count read pairs : no                                               ||
||              Annotation : hsa.gff3 (GTF)                                   ||
||      Dir for temp files : ./                                               ||
||                                                                            ||
||                 Threads : 8                                                ||
||                   Level : meta-feature level                               ||
||      Multimapping reads : not counted                                      ||
|| Multi-overlapping reads : not counted                                      ||
||   Min overlapping bases : 1                                                ||
||                                                                            ||
\\============================================================================//

//================================= Running ==================================\\
||                                                                            ||
|| Load annotation file hsa.gff3 ...                                          ||
||    Features : 2883                                                         ||
||    Meta-features : 2652                                                    ||
||    Chromosomes/contigs : 24                                                ||
||                                                                            ||
|| Process BAM file aligned1_relaxed.sorted.bam...                            ||
||    Single-end reads are included.                                          ||
||    Total alignments : 13076550                                             ||
||    Successfully assigned alignments : 71 (0.0%)                            ||
||    Running time : 0.02 minutes                                             ||
||                                                                            ||
|| Write the final count table.                                               ||
|| Write the read assignment summary.                                         ||
||                                                                            ||
|| Summary of counting results can be found in file "counts_mature_relaxed.t  ||
|| xt.summary"                                                                ||
||                                                                            ||
\\============================================================================//
```

è¿™æ‰¹æ•°æ®***åœ¨ genome æ¯”å¯¹å’Œ featureCounts ä¸Šåˆ†é…ç‡æä½ï¼Œè€Œä¸” adapter åºåˆ—ä¸ç¡®å®š***ï¼Œè½¬å‘ **Salmon + mature.fa** ã€‚Salmon æ˜¯è½»é‡çº§ã€å¿«é€Ÿä¸”é€‚åˆå¤„ç†çŸ­åºåˆ—çš„å·¥å…·ï¼Œå°¤å…¶åœ¨ miRNA è¡¨è¾¾å®šé‡æ–¹é¢è¡¨ç°å‡ºè‰²ã€‚

## ğŸ§© Salmon å®šé‡æµç¨‹ï¼ˆåŸºäº mature.faï¼‰

å·²ç»æœ‰ï¼š

-   æ¸…æ´—åçš„ readsï¼š`trimmed.fastq`

-   miRNA è½¬å½•æœ¬å‚è€ƒï¼š`mature.fa`

-   Salmon indexï¼š`mirna_index`

æˆ‘ä»¬ç›´æ¥è¿›å…¥å®šé‡ï¼š

### âœ… Salmon quant å‘½ä»¤

bash

```         
salmon quant -i mirna_index \
  -l SR \
  -r ~/miRNA/data/data/fastq/trimmed.fastq \
  -o salmon_quant1 \
  --gcBias --validateMappings
```

### å‚æ•°è¯´æ˜ï¼š

-   `-i mirna_index`ï¼šä½ å·²ç»æ„å»ºå¥½çš„ indexï¼ˆåŸºäº mature.faï¼‰

-   `-l SR`ï¼šå•ç«¯æ•°æ®ï¼ŒSalmon ä¼šè‡ªåŠ¨æ¨æ–­æ–¹å‘æ€§

-   `-r trimmed.fastq`ï¼šè¾“å…¥ reads

-   `-o salmon_quant`ï¼šè¾“å‡ºç›®å½•

-   `--gcBias`ï¼šæ ¡æ­£ GC åå€š

-   `--validateMappings`ï¼šæé«˜ mapping ç²¾åº¦

``` bash
jayz@localhost:~/miRNA/data$ salmon quant -i mirna_index \
  -l SR \
  -r ~/miRNA/data/data/fastq/trimmed.fastq \
  -o salmon_quant1 \
  --gcBias --validateMappings
### salmon (selective-alignment-based) v1.10.2
### [ program ] => salmon
### [ command ] => quant
### [ index ] => { mirna_index }
### [ libType ] => { SR }
### [ unmatedReads ] => { /home/jayz/miRNA/data/data/fastq/trimmed.fastq }
### [ output ] => { salmon_quant1 }
### [ gcBias ] => { }
### [ validateMappings ] => { }
Logs will be written to salmon_quant1/logs
-----------------------------------------
| Loading contig table | Time = 8.2816 ms
-----------------------------------------
size = 53161
-----------------------------------------
| Loading contig offsets | Time = 1.0266 ms
-----------------------------------------
-----------------------------------------
| Loading reference lengths | Time = 1.0923 ms
-----------------------------------------
-----------------------------------------
| Loading mphf table | Time = 1.4715 ms
-----------------------------------------
size = 1121286
Number of ones: 53160
Number of ones per inventory item: 512
[2025-10-23 11:46:06.882] [jointLog] [info] setting maxHashResizeThreads to 16
[2025-10-23 11:46:06.882] [jointLog] [info] Fragment incompatibility prior below threshold.  Incompatible fragments will be ignored.
[2025-10-23 11:46:06.883] [jointLog] [info] Usage of --validateMappings implies use of minScoreFraction. Since not explicitly specified, it is being set to 0.65
[2025-10-23 11:46:06.884] [jointLog] [info] Setting consensusSlack to selective-alignment default of 0.35.
[2025-10-23 11:46:06.884] [jointLog] [info] parsing read library format
[2025-10-23 11:46:06.886] [jointLog] [info] There is 1 library.
[2025-10-23 11:46:06.886] [jointLog] [info] Loading pufferfish index
[2025-10-23 11:46:06.887] [jointLog] [info] Loading dense pufferfish index.
Inventory entries filled: 104
-----------------------------------------
| Loading contig boundaries | Time = 3.5324 ms
-----------------------------------------
size = 1121286
-----------------------------------------
| Loading sequence | Time = 1.2584 ms
-----------------------------------------
size = 270726
-----------------------------------------
| Loading positions | Time = 2.5511 ms
-----------------------------------------
size = 1051325
-----------------------------------------
| Loading reference sequence | Time = 1.422 ms
-----------------------------------------
-----------------------------------------
| Loading reference accumulative lengths | Time = 1.4039 ms
-----------------------------------------
[2025-10-23 11:46:06.910] [jointLog] [info] done
[2025-10-23 11:46:06.980] [jointLog] [info] Index contained 48204 targets
[2025-10-23 11:46:06.990] [jointLog] [info] Number of decoys : 0
[2025-10-23 11:46:06.993] [jointLog] [warning] Fragment GC bias correction is currently *experimental* in single-end libraries.  Please use this option with caution.



processed 1000000 fragments
hits: 0; hits per frag:  0[2025-10-23 11:46:07.539] [jointLog] [warning] salmon was only able to assign 0 fragments to transcripts in the index, but the minimum number of required assigned fragments (--minAssignedFrags) was 10. This could be indicative of a mismatch between the reference and sample, or a very bad sample.  You can change the --minAssignedFrags parameter to force salmon to quantify with fewer assigned fragments (must have at least 1).
```