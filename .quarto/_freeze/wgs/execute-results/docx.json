{
  "hash": "4db233b49680b613fdeff2fbdeb8ffa8",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: genome\n---\n\n\n\n**æ¨æ˜† 11312023119**\n\nmade by jayz\n\n### ğŸ§¬ æ•°æ®æ¥æºä¸èƒŒæ™¯\n\n-   **é¡¹ç›®åç§°**ï¼šCDC Traveler-Based Genomic Surveillance Program\n\n-   **æäº¤å•ä½**ï¼šGinkgo Bioworksï¼ˆé€šè¿‡å…¶å­å…¬å¸ Concentric æ‰§è¡Œæµ‹åºä»»åŠ¡ï¼‰\n\n-   **ç›®æ ‡**ï¼šç›‘æµ‹ä»å¤šä¸ªç¾å›½ä¸»è¦æœºåœºå…¥å¢ƒçš„å›½é™…æ—…å®¢æ‰€æºå¸¦çš„ SARS-CoV-2 å˜å¼‚æ ªåŠå…¶ä»–ç—…åŸä½“ï¼Œè¿›è¡ŒåŸºå› ç»„æµ‹åºåˆ†æã€‚\n\n### ğŸ“¦ æ ·æœ¬ä¸å®éªŒä¿¡æ¯\n\n| å­—æ®µ                  | å†…å®¹          | è¯´æ˜                                   |\n|--------------------|------------------|----------------------------------|\n| **Sample ID**         | SAMN52666403  | ç”Ÿç‰©æ ·æœ¬ç¼–å·                           |\n| **SRA Experiment ID** | SRS26846718   | å®éªŒç¼–å·                               |\n| **Organism**          | SARS-CoV-2    | æµ‹åºå¯¹è±¡ä¸ºæ–°å† ç—…æ¯’                     |\n| **Library Name**      | COVID-19 WGS  | è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå…¨åŸºå› ç»„æµ‹åºï¼ˆWGSï¼‰åº“      |\n| **Instrument**        | Element AVITI | ä½¿ç”¨çš„æµ‹åºä»ªå™¨å‹å·                     |\n| **Strategy**          | AMPLICON      | ä½¿ç”¨æ‰©å¢å­æµ‹åºç­–ç•¥ï¼Œå¸¸ç”¨äºå˜å¼‚æ£€æµ‹     |\n| **Source**            | VIRAL RNA     | æ ·æœ¬æ¥æºä¸ºç—…æ¯’ RNA                     |\n| **Selection**         | RT-PCR        | ä½¿ç”¨é€†è½¬å½• PCR æŠ€æœ¯è¿›è¡Œæ ·æœ¬é€‰æ‹©ä¸æ‰©å¢  |\n| **Layout**            | PAIRED        | åŒç«¯æµ‹åºï¼ˆpaired-endï¼‰ï¼Œæé«˜æµ‹åºå‡†ç¡®æ€§ |\n\n### ğŸ“Š æ•°æ®é‡ä¸è¿è¡Œä¿¡æ¯\n\n| å­—æ®µ               | å†…å®¹        | è¯´æ˜                             |\n|--------------------|-------------|----------------------------------|\n| **Run ID**         | SRR35790159 | å…·ä½“è¿è¡Œç¼–å·ï¼Œå¯ç”¨äºä¸‹è½½åŸå§‹æ•°æ® |\n| **Spots**          | 2,320,503   | æµ‹åºè¯»å–æ•°ï¼ˆreadsï¼‰æˆ–æµ‹åºç‚¹æ•°    |\n| **Bases**          | 464.1M      | æ€»ç¢±åŸºæ•°ï¼ˆå³è¯»å–çš„æ ¸è‹·é…¸æ€»æ•°ï¼‰   |\n| **Size**           | 271.9Mb     | ä¸‹è½½æ•°æ®çš„å¤§å°                   |\n| **Published Date** | 2025-10-14  | æ•°æ®å…¬å¼€æ—¶é—´                     |\n\n``` bash          \njayz@localhost:~$ mkdir yankun\njayz@localhost:~$ cd yankun\njayz@localhost:~/yankun$ mkdir data\njayz@localhost:~/yankun$ cd data\n```\n``` bash          \njayz@localhost:~/yankun/data$ prefetch SRR35790159\n\n2025-10-17T03:00:37 prefetch.3.0.3: Current preference is set to retrieve SRA Normalized Format files with full base quality scores.\n2025-10-17T03:00:38 prefetch.3.0.3: 1) Downloading 'SRR35790159'...\n2025-10-17T03:00:38 prefetch.3.0.3: SRA Normalized Format file is being retrieved, if this is different from your preference, it may be due to current file availability.\n2025-10-17T03:00:38 prefetch.3.0.3:  Downloading via HTTPS...\n2025-10-17T03:01:04 prefetch.3.0.3:  HTTPS download succeed\n2025-10-17T03:01:04 prefetch.3.0.3:  'SRR35790159' is valid\n2025-10-17T03:01:04 prefetch.3.0.3: 1) 'SRR35790159' was downloaded successfully\n2025-10-17T03:01:04 prefetch.3.0.3: 'SRR35790159' has 0 unresolved dependencies\n```\n\n``` bash         \njayz@localhost:~/yankun/data$ ls\nSRR35790159\njayz@localhost:~/yankun/data$ fasterq-dump SRR35790159\nspots read      : 2,320,503\nreads read      : 4,641,006\nreads written   : 4,641,006\njayz@localhost:~/yankun/data$ fasterq-dump SRR35790159 --split-files -O fastq_files\nspots read      : 2,320,503\nreads read      : 4,641,006\nreads written   : 4,641,006\njayz@localhost:~/yankun/data$ ls\nSRR35790159  SRR35790159_1.fastq  SRR35790159_2.fastq  fastq_files\n```\n\n``` bash          \njayz@localhost:~/yankun/data$ fastqc SRR35790159_1.fastq  SRR35790159_2.fastq\nnull\nnull\nStarted analysis of SRR35790159_1.fastq\nApprox 5% complete for SRR35790159_1.fastq\nApprox 10% complete for SRR35790159_1.fastq\nApprox 15% complete for SRR35790159_1.fastq\nApprox 20% complete for SRR35790159_1.fastq\nApprox 25% complete for SRR35790159_1.fastq\nApprox 30% complete for SRR35790159_1.fastq\nApprox 35% complete for SRR35790159_1.fastq\nApprox 40% complete for SRR35790159_1.fastq\nApprox 45% complete for SRR35790159_1.fastq\nApprox 50% complete for SRR35790159_1.fastq\nApprox 55% complete for SRR35790159_1.fastq\nApprox 60% complete for SRR35790159_1.fastq\nApprox 65% complete for SRR35790159_1.fastq\nApprox 70% complete for SRR35790159_1.fastq\nApprox 75% complete for SRR35790159_1.fastq\nApprox 80% complete for SRR35790159_1.fastq\nApprox 85% complete for SRR35790159_1.fastq\nApprox 90% complete for SRR35790159_1.fastq\nApprox 95% complete for SRR35790159_1.fastq\nAnalysis complete for SRR35790159_1.fastq\nStarted analysis of SRR35790159_2.fastq\nApprox 5% complete for SRR35790159_2.fastq\nApprox 10% complete for SRR35790159_2.fastq\nApprox 15% complete for SRR35790159_2.fastq\nApprox 20% complete for SRR35790159_2.fastq\nApprox 25% complete for SRR35790159_2.fastq\nApprox 30% complete for SRR35790159_2.fastq\nApprox 35% complete for SRR35790159_2.fastq\nApprox 40% complete for SRR35790159_2.fastq\nApprox 45% complete for SRR35790159_2.fastq\nApprox 50% complete for SRR35790159_2.fastq\nApprox 55% complete for SRR35790159_2.fastq\nApprox 60% complete for SRR35790159_2.fastq\nApprox 65% complete for SRR35790159_2.fastq\nApprox 70% complete for SRR35790159_2.fastq\nApprox 75% complete for SRR35790159_2.fastq\nApprox 80% complete for SRR35790159_2.fastq\nApprox 85% complete for SRR35790159_2.fastq\nApprox 90% complete for SRR35790159_2.fastq\nApprox 95% complete for SRR35790159_2.fastq\nAnalysis complete for SRR35790159_2.fastq\n```\n\n![](images/å±å¹•æˆªå›¾%202025-10-17%20111119.png)\n\n![](images/å±å¹•æˆªå›¾%202025-10-17%20111523.png)\n\n![](images/å±å¹•æˆªå›¾%202025-10-17%20111528.png)\n\n![](images/å±å¹•æˆªå›¾%202025-10-17%20111534.png)\n\n![](images/å±å¹•æˆªå›¾%202025-10-17%20111541.png)\n\nçœ‹çœ‹ç¬¬äºŒä¸ªfatsqæ–‡ä»¶\n\n![](images/å±å¹•æˆªå›¾%202025-10-17%20112317.png)\n\n### ğŸ”¬ FastQC æ¨¡å—è§£é‡Šä¸åˆ†æ\n\n| æ¨¡å— | å«ä¹‰ | æ ‡çº¢çš„å¯èƒ½åŸå›  | æ˜¯å¦å»ºè®®ä½¿ç”¨ `fastp` |\n|------------------|------------------|------------------|------------------|\n| **Per Sequence Content** | æ£€æŸ¥æ¯æ¡ read ä¸­å„ä½ç½®çš„ç¢±åŸºç»„æˆæ˜¯å¦ä¸€è‡´ | AMPLICON æµ‹åºå¸¸è§ï¼Œå› å¼•ç‰©æˆ–æ‰©å¢åå¥½å¯¼è‡´å‰å‡ ä½ç¢±åŸºç»„æˆåç¦» | âœ… æ˜¯ï¼Œ`fastp` å¯å‰ªåˆ‡å‰ç«¯åå·®åŒºåŸŸ |\n| **Per GC Content** | æ£€æŸ¥ reads çš„ GC å«é‡åˆ†å¸ƒæ˜¯å¦ç¬¦åˆæ­£æ€åˆ†å¸ƒ | ç—…æ¯’åŸºå› ç»„ GC å«é‡æœ¬èº«åä½æˆ–æ ·æœ¬æ··æ‚ | âœ… æ˜¯ï¼Œ`fastp` å¯å»é™¤å¼‚å¸¸ readsï¼Œæ”¹å–„åˆ†å¸ƒ |\n| **Sequence Duplication Levels** | æ£€æŸ¥é‡å¤ reads çš„æ¯”ä¾‹ | AMPLICON æµ‹åºä¸­ PCR æ‰©å¢ä¼šå¯¼è‡´é«˜é‡å¤ | âœ… æ˜¯ï¼Œ`fastp` å¯å»é™¤å®Œå…¨é‡å¤ reads |\n| **Overrepresented Sequences** | æ£€æŸ¥æ˜¯å¦å­˜åœ¨é¢‘ç‡å¼‚å¸¸é«˜çš„åºåˆ—ï¼ˆå¦‚æ¥å¤´ã€å¼•ç‰©ï¼‰ | æ¥å¤´æ±¡æŸ“ã€å¼•ç‰©æ®‹ç•™æˆ–æ‰©å¢ä¼ªå½± | âœ… æ˜¯ï¼Œ`fastp` å¯è‡ªåŠ¨è¯†åˆ«å¹¶å»é™¤æ¥å¤´åºåˆ— |\n\n### âœ… æ˜¯å¦æœ‰å¿…è¦ä½¿ç”¨ `fastp`ï¼Ÿ\n\n**éå¸¸æœ‰å¿…è¦ã€‚**\n\nå°½ç®¡ AMPLICON æµ‹åºæœ¬èº«ä¼šå¯¼è‡´æŸäº› FastQC æ¨¡å—åç¦»â€œç†æƒ³çŠ¶æ€â€ï¼Œä½†ï¼š\n\n-   **æ¥å¤´æ±¡æŸ“** å’Œ **é‡å¤ reads** ä¼šå½±å“æ¯”å¯¹æ•ˆç‡å’Œå˜å¼‚æ£€æµ‹å‡†ç¡®æ€§ï¼›\n\n-   **å‰ç«¯ç¢±åŸºåå·®** ä¼šå¹²æ‰°æŸäº›ä¸‹æ¸¸åˆ†æï¼ˆå¦‚å˜å¼‚å®šä½ï¼‰ï¼›\n\n-   `fastp å¯è‡ªåŠ¨å¤„ç†è¿™äº›é—®é¢˜ï¼Œå¹¶ç”Ÿæˆæ–°çš„è´¨æ§æŠ¥å‘Šï¼Œå¸®åŠ©ä½ åˆ¤æ–­æ¸…æ´—æ•ˆæœã€‚`\n\n### ğŸ§ª æ¨è `fastp` å‘½ä»¤ï¼ˆåŒç«¯æ•°æ®ï¼‰\n\n``` bash           \nfastp \\\n  -i SRR35790159_1.fastq \\\n  -I SRR35790159_2.fastq \\\n  -o SRR35790159_trimmed_1.fastq \\\n  -O SRR35790159_trimmed_2.fastq \\\n  --detect_adapter_for_pe \\\n  --trim_poly_g \\\n  --cut_front \\\n  --cut_tail \\\n  --cut_window_size 4 \\\n  --cut_mean_quality 20 \\\n  --length_required 50 \\\n  --thread 8 \\\n  --html SRR35790159_fastp.html \\\n  --json SRR35790159_fastp.json\n```\n\n``` bash          \njayz@localhost:~/yankun/data$ fastp \\\n  -i SRR35790159_1.fastq \\\n  -I SRR35790159_2.fastq \\\n  -o SRR35790159_trimmed_1.fastq \\\n  -O SRR35790159_trimmed_2.fastq \\\n  --detect_adapter_for_pe \\\n  --trim_poly_g \\\n  --cut_front \\\n  --cut_tail \\\n  --cut_window_size 4 \\\n  --cut_mean_quality 20 \\\n  --length_required 50 \\\n  --thread 8 \\\n  --html SRR35790159_fastp.html \\\n  --json SRR35790159_fastp.json\nDetecting adapter sequence for read1...\n>I7_Nextera_Transposase_1 | >Trans2_rc | >I7_Nextera_Transposase_1 | >Trans2_rc\nCTGTCTCTTATACACATCTCCGAGCCCACGAGAC\n\nDetecting adapter sequence for read2...\n>I5_Nextera_Transposase_1 | >Trans1_rc | >I5_Nextera_Transposase_1 | >Trans1_rc\nCTGTCTCTTATACACATCTGACGCTGCCGACGA\n\nRead1 before filtering:\ntotal reads: 2320503\ntotal bases: 232050300\nQ20 bases: 219390368(94.5443%)\nQ30 bases: 212369986(91.5189%)\n\nRead2 before filtering:\ntotal reads: 2320503\ntotal bases: 232050300\nQ20 bases: 220444754(94.9987%)\nQ30 bases: 215945831(93.0599%)\n\nRead1 after filtering:\ntotal reads: 2198482\ntotal bases: 215526175\nQ20 bases: 212304242(98.5051%)\nQ30 bases: 205663485(95.4239%)\n\nRead2 after filtering:\ntotal reads: 2198482\ntotal bases: 215591822\nQ20 bases: 213302358(98.9381%)\nQ30 bases: 209004462(96.9445%)\n\nFiltering result:\nreads passed filter: 4396964\nreads failed due to low quality: 660\nreads failed due to too many N: 356\nreads failed due to too short: 243026\nreads with adapter trimmed: 535660\nbases trimmed due to adapters: 12174695\n\nDuplication rate: 70.2497%\n\nInsert size peak (evaluated by paired-end reads): 148\n\nJSON report: SRR35790159_fastp.json\nHTML report: SRR35790159_fastp.html\n\nfastp -i SRR35790159_1.fastq -I SRR35790159_2.fastq -o SRR35790159_trimmed_1.fastq -O SRR35790159_trimmed_2.fastq --detect_adapter_for_pe --trim_poly_g --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --length_required 50 --thread 8 --html SRR35790159_fastp.html --json SRR35790159_fastp.json\n```\n\n![](images/å±å¹•æˆªå›¾%202025-10-17%20113314.png)\n\nä¹‹åfastqcæŸ¥çœ‹ä¸€ä¸‹\n\n``` bash           \njayz@localhost:~/yankun/data$ fastqc SRR35790159_trimmed_1.fastq SRR35790159_trimmed_2.fastq\nnull\nnull\nStarted analysis of SRR35790159_trimmed_1.fastq\nApprox 5% complete for SRR35790159_trimmed_1.fastq\nApprox 10% complete for SRR35790159_trimmed_1.fastq\nApprox 15% complete for SRR35790159_trimmed_1.fastq\nApprox 20% complete for SRR35790159_trimmed_1.fastq\nApprox 25% complete for SRR35790159_trimmed_1.fastq\nApprox 30% complete for SRR35790159_trimmed_1.fastq\nApprox 35% complete for SRR35790159_trimmed_1.fastq\nApprox 40% complete for SRR35790159_trimmed_1.fastq\nApprox 45% complete for SRR35790159_trimmed_1.fastq\nApprox 50% complete for SRR35790159_trimmed_1.fastq\nApprox 55% complete for SRR35790159_trimmed_1.fastq\nApprox 60% complete for SRR35790159_trimmed_1.fastq\nApprox 65% complete for SRR35790159_trimmed_1.fastq\nApprox 70% complete for SRR35790159_trimmed_1.fastq\nApprox 75% complete for SRR35790159_trimmed_1.fastq\nApprox 80% complete for SRR35790159_trimmed_1.fastq\nApprox 85% complete for SRR35790159_trimmed_1.fastq\nApprox 90% complete for SRR35790159_trimmed_1.fastq\nApprox 95% complete for SRR35790159_trimmed_1.fastq\nAnalysis complete for SRR35790159_trimmed_1.fastq\nStarted analysis of SRR35790159_trimmed_2.fastq\nApprox 5% complete for SRR35790159_trimmed_2.fastq\nApprox 10% complete for SRR35790159_trimmed_2.fastq\nApprox 15% complete for SRR35790159_trimmed_2.fastq\nApprox 20% complete for SRR35790159_trimmed_2.fastq\nApprox 25% complete for SRR35790159_trimmed_2.fastq\nApprox 30% complete for SRR35790159_trimmed_2.fastq\nApprox 35% complete for SRR35790159_trimmed_2.fastq\nApprox 40% complete for SRR35790159_trimmed_2.fastq\nApprox 45% complete for SRR35790159_trimmed_2.fastq\nApprox 50% complete for SRR35790159_trimmed_2.fastq\nApprox 55% complete for SRR35790159_trimmed_2.fastq\nApprox 60% complete for SRR35790159_trimmed_2.fastq\nApprox 65% complete for SRR35790159_trimmed_2.fastq\nApprox 70% complete for SRR35790159_trimmed_2.fastq\nApprox 75% complete for SRR35790159_trimmed_2.fastq\nApprox 80% complete for SRR35790159_trimmed_2.fastq\nApprox 85% complete for SRR35790159_trimmed_2.fastq\nApprox 90% complete for SRR35790159_trimmed_2.fastq\nApprox 95% complete for SRR35790159_trimmed_2.fastq\nAnalysis complete for SRR35790159_trimmed_2.fastq\njayz@localhost:~/yankun/data$ ls\nSRR35790159                SRR35790159_2_fastqc.zip           SRR35790159_trimmed_2.fastq\nSRR35790159_1.fastq        SRR35790159_fastp.html             SRR35790159_trimmed_2_fastqc.html\nSRR35790159_1_fastqc.html  SRR35790159_fastp.json             SRR35790159_trimmed_2_fastqc.zip\nSRR35790159_1_fastqc.zip   SRR35790159_trimmed_1.fastq        fastq_files\nSRR35790159_2.fastq        SRR35790159_trimmed_1_fastqc.html\nSRR35790159_2_fastqc.html  SRR35790159_trimmed_1_fastqc.zip\n```\n\n### ğŸ§¬ æ¨èå‚è€ƒåŸºå› ç»„ï¼šSARS-CoV-2 Wuhan-Hu-1\n\n-   **NCBI RefSeq ID**ï¼šNC_045512.2\n\n-   **æè¿°**ï¼šè¿™æ˜¯æœ€æ—©å‘å¸ƒçš„ SARS-CoV-2 å®Œæ•´å‚è€ƒåŸºå› ç»„ï¼ˆWuhan-Hu-1 æ ªï¼‰\n\n-   **é•¿åº¦**ï¼š29,903 bp\n\n-   **ç”¨é€”**ï¼šå¹¿æ³›ç”¨äºå˜å¼‚æ£€æµ‹ã€æ¯”å¯¹ã€æ³¨é‡Šç­‰åˆ†æä»»åŠ¡\n\n### ğŸ“¥ ä¸‹è½½å‚è€ƒåŸºå› ç»„å¹¶æ”¾å…¥ `reference/` æ–‡ä»¶å¤¹\n\nä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ Linux ç»ˆç«¯ä¸­å®Œæˆä¸‹è½½ï¼š\n\n``` bash          \nmkdir -p reference\ncd reference\n\n# ä¸‹è½½å‚è€ƒåŸºå› ç»„ FASTA æ–‡ä»¶\nwget -O SARS-CoV-2_reference.fasta \"https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/858/895/GCF_009858895.2_ASM985889v3/GCF_009858895.2_ASM985889v3_genomic.fna.gz\"\n\n# è§£å‹\ngunzip GCF_009858895.2_ASM985889v3_genomic.fna.gz\n\n# é‡å‘½åä¸ºç»Ÿä¸€æ ¼å¼\nmv GCF_009858895.2_ASM985889v3_genomic.fna SARS-CoV-2_reference.fasta\n```\n\n``` bash          \njayz@localhost:~/yankun/data/reference$ wget --no-proxy -O SARS-CoV-2_reference.fasta.gz \"https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/858/895/GCF_009858895.2_ASM985889v3/GCF_009858895.2_ASM985889v3_genomic.fna.gz\"\n--2025-10-17 11:42:09--  https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/858/895/GCF_009858895.2_ASM985889v3/GCF_009858895.2_ASM985889v3_genomic.fna.gz\nResolving ftp.ncbi.nlm.nih.gov (ftp.ncbi.nlm.nih.gov)... 130.14.250.11, 130.14.250.12, 130.14.250.31, ...\nConnecting to ftp.ncbi.nlm.nih.gov (ftp.ncbi.nlm.nih.gov)|130.14.250.11|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 9591 (9.4K) [application/x-gzip]\nSaving to: â€˜SARS-CoV-2_reference.fasta.gzâ€™\n\nSARS-CoV-2_reference.fasta.gz 100%[=================================================>]   9.37K  --.-KB/s    in 0s\n\n2025-10-17 11:42:11 (193 MB/s) - â€˜SARS-CoV-2_reference.fasta.gzâ€™ saved [9591/9591]\n\njayz@localhost:~/yankun/data/reference$ ls\nSARS-CoV-2_reference.fasta  SARS-CoV-2_reference.fasta.gz\njayz@localhost:~/yankun/data/reference$\n```\n\n### ä¸‹ä¸€æ­¥å»ºè®®\n\n1.  **æ„å»ºç´¢å¼•ï¼ˆä»¥ bwa ä¸ºä¾‹ï¼‰**ï¼š\n\n    ``` bash           \n    bwa index reference/SARS-CoV-2_reference.fasta\n    ```\n\n``` bash           \njayz@localhost:~/yankun/data$ bwa index reference/SARS-CoV-2_reference.fasta\n[bwa_index] Pack FASTA... 0.00 sec\n[bwa_index] Construct BWT for the packed sequence...\n[bwa_index] 0.00 seconds elapse.\n[bwa_index] Update BWT... 0.00 sec\n[bwa_index] Pack forward-only FASTA... 0.00 sec\n[bwa_index] Construct SA from BWT and Occ... 0.00 sec\n[main] Version: 0.7.17-r1188\n[main] CMD: bwa index reference/SARS-CoV-2_reference.fasta\n[main] Real time: 0.076 sec; CPU: 0.002 sec\n```\n\n-   **æ¯”å¯¹ reads åˆ°å‚è€ƒåŸºå› ç»„**ï¼š\n\n   \n\n    ```bash         \n    bwa mem reference/SARS-CoV-2_reference.fasta \\\n      SRR35790159_trimmed_1.fastq SRR35790159_trimmed_2.fastq \\\n      > SRR35790159_aligned.sam\n    ```\n\n   ``` bash           \n    jayz@localhost:~/yankun/data$ bwa mem reference/SARS-CoV-2_reference.fasta \\\n      SRR35790159_trimmed_1.fastq SRR35790159_trimmed_2.fastq \\\n      > SRR35790159_aligned.sam\n    [M::bwa_idx_load_from_disk] read 0 ALT contigs\n    [M::process] read 101986 sequences (10000008 bp)...\n    [M::process] read 101942 sequences (10000099 bp)...\n    [M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (5, 49958, 0, 8)\n    [M::mem_pestat] skip orientation FF as there are not enough pairs\n    [M::mem_pestat] analyzing insert size distribution for orientation FR...\n    [M::mem_pestat] (25, 50, 75) percentile: (129, 174, 230)\n    [M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 432)\n    [M::mem_pestat] mean and std.dev: (183.42, 72.11)\n    [M::mem_pestat] low and high boundaries for proper pairs: (1, 533)\n    [M::mem_pestat] skip orientation RF as there are not enough pairs\n    [M::mem_pestat] skip orientation RR as there are not enough pairs\n    [M::mem_process_seqs] Processed 101986 reads in 1.489 CPU sec, 1.417 real sec\n    [M::process] read 101990 sequences (10000097 bp)...\n    ...\n    ...\n    [M::mem_pestat] skip orientation FF as there are not enough pairs\n    [M::mem_pestat] analyzing insert size distribution for orientation FR...\n    [M::mem_pestat] (25, 50, 75) percentile: (129, 174, 230)\n    [M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 432)\n    [M::mem_pestat] mean and std.dev: (183.93, 72.18)\n    [M::mem_pestat] low and high boundaries for proper pairs: (1, 533)\n    [M::mem_pestat] skip orientation RF as there are not enough pairs\n    [M::mem_pestat] skip orientation RR as there are not enough pairs\n    [M::mem_process_seqs] Processed 101944 reads in 1.532 CPU sec, 1.488 real sec\n    [M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (1, 5568, 0, 0)\n    [M::mem_pestat] skip orientation FF as there are not enough pairs\n    [M::mem_pestat] analyzing insert size distribution for orientation FR...\n    [M::mem_pestat] (25, 50, 75) percentile: (131, 176, 230)\n    [M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 428)\n    [M::mem_pestat] mean and std.dev: (184.31, 71.90)\n    [M::mem_pestat] low and high boundaries for proper pairs: (1, 527)\n    [M::mem_pestat] skip orientation RF as there are not enough pairs\n    [M::mem_pestat] skip orientation RR as there are not enough pairs\n    [M::mem_process_seqs] Processed 11366 reads in 0.211 CPU sec, 0.176 real sec\n    [main] Version: 0.7.17-r1188\n    [main] CMD: bwa mem reference/SARS-CoV-2_reference.fasta SRR35790159_trimmed_1.fastq SRR35790159_trimmed_2.fastq\n    [main] Real time: 62.444 sec; CPU: 66.297 sec\n    ```\n\n    ``` bash          \n    jayz@localhost:~/yankun/data$ ls\n    SRR35790159                SRR35790159_2_fastqc.zip           SRR35790159_trimmed_1_fastqc.zip   test.sam\n    SRR35790159_1.fastq        SRR35790159_aligned.sam            SRR35790159_trimmed_2.fastq        test_1.fastq\n    SRR35790159_1_fastqc.html  SRR35790159_fastp.html             SRR35790159_trimmed_2_fastqc.html  test_2.fastq\n    SRR35790159_1_fastqc.zip   SRR35790159_fastp.json             SRR35790159_trimmed_2_fastqc.zip   test_minimap.sam\n    SRR35790159_2.fastq        SRR35790159_trimmed_1.fastq        fastq_files\n    SRR35790159_2_fastqc.html  SRR35790159_trimmed_1_fastqc.html  reference\n    ```\n\n-   **è½¬æ¢ä¸º BAM å¹¶æ’åº**ï¼š\n\n    ``` bash           \n    samtools view -Sb SRR35790159_aligned.sam | samtools sort -o SRR35790159_sorted.bam\n    samtools index SRR35790159_sorted.bam\n    ```\n\n   ``` bash         \n    jayz@localhost:~/yankun/data$ samtools view -Sb SRR35790159_aligned.sam | samtools sort -o SRR35790159_sorted.bam\n    [bam_sort_core] merging from 1 files and 1 in-memory blocks...\n    jayz@localhost:~/yankun/data$ samtools index SRR35790159_sorted.bam\n    ```\n\n-   **è¦†ç›–åº¦åˆ†æ**ï¼š\n\n    ``` bash           \n    samtools depth SRR35790159_sorted.bam > SRR35790159_coverage.txt \n    ```\n\n    ``` bash          \n    jayz@localhost:~/yankun/data$ samtools view -Sb SRR35790159_aligned.sam | samtools sort -o SRR35790159_sorted.bam\n    [bam_sort_core] merging from 1 files and 1 in-memory blocks...\n    jayz@localhost:~/yankun/data$ samtools index SRR35790159_sorted.bam\n    jayz@localhost:~/yankun/data$ samtools depth SRR35790159_sorted.bam > SRR35790159_coverage.txt\n    jayz@localhost:~/yankun/data$ head SRR35790159_coverage.txt -n 10\n    NC_045512.2     47      1\n    NC_045512.2     48      5\n    NC_045512.2     49      9\n    NC_045512.2     50      9\n    NC_045512.2     51      9\n    NC_045512.2     52      9\n    NC_045512.2     53      11\n    NC_045512.2     54      15\n    NC_045512.2     55      15\n    NC_045512.2     56      30\n    ```\n\n    è¡¨ç¤ºå‚è€ƒåºåˆ— `NC_045512.2` çš„ç¬¬ 47 ä¸ªç¢±åŸºä½ç½®è¢«è¦†ç›–äº† 1 æ¬¡\n\n### ğŸ” å¿«é€Ÿåˆ†æ\n\n-   ä»ç¬¬ 47 ä½å¼€å§‹ï¼Œè¦†ç›–åº¦é€æ¸ä¸Šå‡ï¼Œè¯´æ˜æµ‹åº reads åœ¨è¿™ä¸ªåŒºåŸŸå¼€å§‹æœ‰æ¯”å¯¹ã€‚\n\n-   ç¬¬ 56 ä½è¦†ç›–åº¦è¾¾åˆ° 30ï¼Œè¯´æ˜è¯¥åŒºåŸŸå¯èƒ½æ˜¯ reads å¯Œé›†åŒºåŸŸæˆ– PCR å¯Œé›†åŒºåŸŸã€‚\n\næŠŠæ–‡ä»¶å¯¼å…¥windowså¯è§†åŒ–ï¼Œä¸æƒ³åœ¨linuxåšï¼Œå› ä¸ºä¸‹åŒ…å¤ªæ…¢äº†\n\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\ndf = pd.read_csv(r\"E:\\acode\\wsl\\data4\\SRR35790159_coverage.txt\", sep=\"\\t\", header=None, names=[\"ref\", \"pos\", \"depth\"])\nplt.figure(figsize=(12, 4))\nplt.plot(df[\"pos\"], df[\"depth\"], color=\"steelblue\")\nplt.xlabel(\"Position on reference\")\nplt.ylabel(\"Coverage depth\")\nplt.title(\"Coverage profile of SRR35790159\")\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](wgs_files/figure-docx/cell-2-output-1.png){}\n:::\n:::\n\n\n![](plot-33.png)\n\n#### âœ… æ€»è¦†ç›–ä½ç½®æ•°ï¼ˆå³æœ‰ reads è¦†ç›–çš„ä½ç½®æ•°ï¼‰\n\n``` bash          \nwc -l SRR35790159_coverage.txt \n```\n``` bash          \njayz@localhost:~/yankun/data$ wc -l SRR35790159_coverage.txt\n26444 SRR35790159_coverage.txt\n```\n\n#### âœ… å¹³å‡è¦†ç›–æ·±åº¦\n\n``` bash       \nawk '{sum+=$3} END {print \"Average depth:\", sum/NR}' SRR35790159_coverage.txt \n```\n\n``` bash         \njayz@localhost:~/yankun/data$ awk '{sum+=$3} END {print \"Average depth:\", sum/NR}' SRR35790159_coverage.txt\nAverage depth: 15891\n```\n\n#### âœ… æœ€å¤§è¦†ç›–æ·±åº¦\n\n``` bash          \nawk 'max<$3{max=$3} END{print \"Max depth:\", max}' SRR35790159_coverage.txt \n```\n\n``` bash          \njayz@localhost:~/yankun/data$ awk 'max<$3{max=$3} END{print \"Max depth:\", max}' SRR35790159_coverage.txt\nMax depth: 419399\n```\n\n#### âœ… æœ€å°è¦†ç›–æ·±åº¦ï¼ˆéé›¶ï¼‰\n\n``` bash           \nawk 'min==0 || ($3<min && $3>0){min=$3} END{print \"Min depth:\", min}' SRR35790159_coverage.txt \n```\n\n``` bash           \njayz@localhost:~/yankun/data$ awk 'min==0 || ($3<min && $3>0){min=$3} END{print \"Min depth:\", min}' SRR35790159_coverage.txt\nMin depth: 1\n```\n\n### âœ… ç­›é€‰å‡ºè¦†ç›–åº¦ \\>30Ã— çš„åŒºåŸŸæ€»æ•°\n\n``` bash          \nawk '$3 > 30 {count++} END {print \"Positions with depth >30x:\", count}' SRR35790159_coverage.txt \n```\n\n``` bash          \njayz@localhost:~/yankun/data$ awk '$3 > 30 {count++} END {print \"Positions with depth >30x:\", count}' SRR35790159_coverage.txt\nPositions with depth >30x: 22451\n```\n\nå¦‚æœæƒ³è®¡ç®—æ¯”ä¾‹ï¼ˆè¦†ç›–åº¦ \\>30Ã— çš„åŒºåŸŸå æ€»å‚è€ƒé•¿åº¦ï¼‰ï¼š\n\n``` bash          \ntotal=$(wc -l < SRR35790159_coverage.txt)\nhigh=$(awk '$3 > 30 {count++} END {print count}' SRR35790159_coverage.txt)\necho \"Proportion >30x: \" $(echo \"$high/$total\" | bc -l)\n```\n\n``` bash           \njayz@localhost:~/yankun/data$ total=$(wc -l < SRR35790159_coverage.txt)\nhigh=$(awk '$3 > 30 {count++} END {print count}' SRR35790159_coverage.txt)\necho \"Proportion >30x: \" $(echo \"$high/$total\" | bc -l)\nProportion >30x:  .84900166389351081530\n```\n\nå‘ç°çº¦ 84.9% çš„å‚è€ƒåŒºåŸŸè¦†ç›–åº¦é«˜äº 30Ã—\n\n## SNPå˜å¼‚åˆ†æ\n\n## ğŸ§± ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆé«˜è¦†ç›–åŒºåŸŸ BED æ–‡ä»¶ï¼ˆ\\>30Ã—ï¼‰\n\n``` bash          \nawk '$3 > 30 {print $1\"\\t\"$2-1\"\\t\"$2}' SRR35790159_coverage.txt > high_coverage.bed \n```\n\nè¯´æ˜ï¼š\n\n-   BED æ ¼å¼æ˜¯ 0-based å·¦é—­å³å¼€ï¼Œæ‰€ä»¥ `start = pos - 1`, `end = pos`\n\n-   è¾“å‡ºæ ¼å¼ä¸ºï¼š`<ref> <start> <end>`\n\n##  ç¬¬äºŒæ­¥ï¼šSNP Calling æµç¨‹ï¼ˆæ¨èç”¨ bcftoolsï¼‰\n\nï¼š\n\n-   æ’åºåçš„ BAM æ–‡ä»¶ï¼š`SRR35790159_sorted.bam`\n\n-   ç´¢å¼•æ–‡ä»¶ï¼š`SRR35790159_sorted.bam.bai`\n\n-   å‚è€ƒåºåˆ—ï¼š`SARS-CoV-2_reference.fasta`ï¼ˆå·²ç´¢å¼•ï¼‰\n\n### âœ… 1. åˆ›å»º mpileupï¼ˆé™åˆ¶åœ¨é«˜è¦†ç›–åŒºåŸŸï¼‰\n\n``` bash          \nbcftools mpileup --threads 8 -f reference/SARS-CoV-2_reference.fasta SRR35790159_sorted.bam -Oz -o raw.vcf.gz\n\n#threads 8 ,8æ ¸å¿ƒåŠ å¿«é€Ÿåº¦\n```\n\n### âœ… 2. SNP Calling\n\n``` bash        \nbcftools call -m --ploidy 1 -Oz -o call.vcf.gz raw.vcf.gz\n```\n\n## ğŸ§­ ç´¢å¼• VCF æ–‡ä»¶\n\nä½¿ç”¨ `tabix` ä¸ºå‹ç¼©çš„ VCF æ–‡ä»¶åˆ›å»ºç´¢å¼•ï¼š\n\n\n\n``` bash        \ntabix -p vcf call.vcf.gz \n```\n\nè¿™ä¼šç”Ÿæˆ `call.vcf.gz.tbi` ç´¢å¼•æ–‡ä»¶ï¼Œä¾›åç»­å¿«é€ŸæŸ¥è¯¢å’Œå¯è§†åŒ–ä½¿ç”¨ã€‚\n\n## ğŸ“Š å¯è§†åŒ– SNP åˆ†å¸ƒï¼ˆPythonï¼‰\n\nä½ å¯ä»¥ç”¨ `pysam` æˆ– `cyvcf2` è¯»å– VCF æ–‡ä»¶å¹¶ç”¨ `matplotlib` å¯è§†åŒ– SNP åˆ†å¸ƒï¼š\n\n### âœ… ç¤ºä¾‹ï¼šç»˜åˆ¶ SNP åœ¨å‚è€ƒåºåˆ—ä¸Šçš„ä½ç½®åˆ†å¸ƒ\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nimport gzip\nimport matplotlib.pyplot as plt\n\npositions = []\nwith gzip.open(r\"E:\\acode\\wsl\\data4\\call.vcf.gz\", \"rt\") as f:\n    for line in f:\n        if line.startswith(\"#\"):\n            continue\n        fields = line.strip().split(\"\\t\")\n        pos = int(fields[1])\n        positions.append(pos)\n\nplt.figure(figsize=(12, 4))\nplt.hist(positions, bins=100, color=\"darkorange\", edgecolor=\"black\")\nplt.xlabel(\"Position on reference genome\")\nplt.ylabel(\"SNP count\")\nplt.title(\"SNP Distribution Across Reference\")\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](wgs_files/figure-docx/cell-3-output-1.png){}\n:::\n:::\n\n\n### âœ… ç¤ºä¾‹ï¼šç»Ÿè®¡ SNP æ•°é‡å’Œè´¨é‡åˆ†å¸ƒ\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nimport gzip\nimport matplotlib.pyplot as plt\n\nqual_scores = []\nwith gzip.open(r\"E:\\acode\\wsl\\data4\\call.vcf.gz\", \"rt\") as f:\n    for line in f:\n        if line.startswith(\"#\"):\n            continue\n        fields = line.strip().split(\"\\t\")\n        qual_field = fields[5]\n        if qual_field != \".\":\n            try:\n                qual = float(qual_field)\n                qual_scores.append(qual)\n            except ValueError:\n                continue  # å¿½ç•¥æ— æ³•è§£æçš„è´¨é‡å€¼\n\nplt.figure(figsize=(8, 4))\nplt.hist(qual_scores, bins=50, color=\"steelblue\", edgecolor=\"black\")\nplt.xlabel(\"SNP Quality Score\")\nplt.ylabel(\"Count\")\nplt.title(\"SNP Quality Distribution\")\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](wgs_files/figure-docx/cell-4-output-1.png){}\n:::\n:::\n\n\n```bash\njayz@localhost:~/yankun$ tree\nâ””â”€â”€ data\n    â”œâ”€â”€ SRR35790159\n    â”‚Â Â  â””â”€â”€ SRR35790159.sra\n    â”œâ”€â”€ SRR35790159_1.fastq\n    â”œâ”€â”€ SRR35790159_1_fastqc.html\n    â”œâ”€â”€ SRR35790159_1_fastqc.zip\n    â”œâ”€â”€ SRR35790159_2.fastq\n    â”œâ”€â”€ SRR35790159_2_fastqc.html\n    â”œâ”€â”€ SRR35790159_2_fastqc.zip\n    â”œâ”€â”€ SRR35790159_aligned.sam\n    â”œâ”€â”€ SRR35790159_coverage.txt\n    â”œâ”€â”€ SRR35790159_fastp.html\n    â”œâ”€â”€ SRR35790159_fastp.json\n    â”œâ”€â”€ SRR35790159_raw.bcf\n    â”œâ”€â”€ SRR35790159_sorted.bam\n    â”œâ”€â”€ SRR35790159_sorted.bam.bai\n    â”œâ”€â”€ SRR35790159_trimmed_1.fastq\n    â”œâ”€â”€ SRR35790159_trimmed_1_fastqc.html\n    â”œâ”€â”€ SRR35790159_trimmed_1_fastqc.zip\n    â”œâ”€â”€ SRR35790159_trimmed_2.fastq\n    â”œâ”€â”€ SRR35790159_trimmed_2_fastqc.html\n    â”œâ”€â”€ SRR35790159_trimmed_2_fastqc.zip\n    â”œâ”€â”€ call.vcf.gz\n    â”œâ”€â”€ call.vcf.gz.tbi\n    â”œâ”€â”€ fastq_files\n    â”‚Â Â  â”œâ”€â”€ SRR35790159_1.fastq\n    â”‚Â Â  â””â”€â”€ SRR35790159_2.fastq\n    â”œâ”€â”€ high_coverage.bed\n    â”œâ”€â”€ raw.vcf.gz\n    â”œâ”€â”€ reference\n    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta\n    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.amb\n    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.ann\n    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.bwt\n    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.fai\n    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.gz\n    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.pac\n    â”‚Â Â  â””â”€â”€ SARS-CoV-2_reference.fasta.sa\n    â”œâ”€â”€ test.sam\n    â”œâ”€â”€ test_1.fastq\n    â”œâ”€â”€ test_2.fastq\n    â””â”€â”€ test_minimap.sam\n\n5 directories, 38 files\n\n```\n\n",
    "supporting": [
      "wgs_files"
    ],
    "filters": []
  }
}