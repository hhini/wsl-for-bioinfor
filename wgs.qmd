# genome

**æ¨æ˜† 11312023119**

made by jayz

### ğŸ§¬ æ•°æ®æ¥æºä¸èƒŒæ™¯

-   **é¡¹ç›®åç§°**ï¼šCDC Traveler-Based Genomic Surveillance Program

-   **æäº¤å•ä½**ï¼šGinkgo Bioworksï¼ˆé€šè¿‡å…¶å­å…¬å¸ Concentric æ‰§è¡Œæµ‹åºä»»åŠ¡ï¼‰

-   **ç›®æ ‡**ï¼šç›‘æµ‹ä»å¤šä¸ªç¾å›½ä¸»è¦æœºåœºå…¥å¢ƒçš„å›½é™…æ—…å®¢æ‰€æºå¸¦çš„ SARS-CoV-2 å˜å¼‚æ ªåŠå…¶ä»–ç—…åŸä½“ï¼Œè¿›è¡ŒåŸºå› ç»„æµ‹åºåˆ†æã€‚

### ğŸ“¦ æ ·æœ¬ä¸å®éªŒä¿¡æ¯

| å­—æ®µ                  | å†…å®¹          | è¯´æ˜                                   |
|--------------------|------------------|----------------------------------|
| **Sample ID**         | SAMN52666403  | ç”Ÿç‰©æ ·æœ¬ç¼–å·                           |
| **SRA Experiment ID** | SRS26846718   | å®éªŒç¼–å·                               |
| **Organism**          | SARS-CoV-2    | æµ‹åºå¯¹è±¡ä¸ºæ–°å† ç—…æ¯’                     |
| **Library Name**      | COVID-19 WGS  | è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå…¨åŸºå› ç»„æµ‹åºï¼ˆWGSï¼‰åº“      |
| **Instrument**        | Element AVITI | ä½¿ç”¨çš„æµ‹åºä»ªå™¨å‹å·                     |
| **Strategy**          | AMPLICON      | ä½¿ç”¨æ‰©å¢å­æµ‹åºç­–ç•¥ï¼Œå¸¸ç”¨äºå˜å¼‚æ£€æµ‹     |
| **Source**            | VIRAL RNA     | æ ·æœ¬æ¥æºä¸ºç—…æ¯’ RNA                     |
| **Selection**         | RT-PCR        | ä½¿ç”¨é€†è½¬å½• PCR æŠ€æœ¯è¿›è¡Œæ ·æœ¬é€‰æ‹©ä¸æ‰©å¢  |
| **Layout**            | PAIRED        | åŒç«¯æµ‹åºï¼ˆpaired-endï¼‰ï¼Œæé«˜æµ‹åºå‡†ç¡®æ€§ |

### ğŸ“Š æ•°æ®é‡ä¸è¿è¡Œä¿¡æ¯

| å­—æ®µ               | å†…å®¹        | è¯´æ˜                             |
|--------------------|-------------|----------------------------------|
| **Run ID**         | SRR35790159 | å…·ä½“è¿è¡Œç¼–å·ï¼Œå¯ç”¨äºä¸‹è½½åŸå§‹æ•°æ® |
| **Spots**          | 2,320,503   | æµ‹åºè¯»å–æ•°ï¼ˆreadsï¼‰æˆ–æµ‹åºç‚¹æ•°    |
| **Bases**          | 464.1M      | æ€»ç¢±åŸºæ•°ï¼ˆå³è¯»å–çš„æ ¸è‹·é…¸æ€»æ•°ï¼‰   |
| **Size**           | 271.9Mb     | ä¸‹è½½æ•°æ®çš„å¤§å°                   |
| **Published Date** | 2025-10-14  | æ•°æ®å…¬å¼€æ—¶é—´                     |

``` bash          
jayz@localhost:~$ mkdir yankun
jayz@localhost:~$ cd yankun
jayz@localhost:~/yankun$ mkdir data
jayz@localhost:~/yankun$ cd data
```
``` bash          
jayz@localhost:~/yankun/data$ prefetch SRR35790159

2025-10-17T03:00:37 prefetch.3.0.3: Current preference is set to retrieve SRA Normalized Format files with full base quality scores.
2025-10-17T03:00:38 prefetch.3.0.3: 1) Downloading 'SRR35790159'...
2025-10-17T03:00:38 prefetch.3.0.3: SRA Normalized Format file is being retrieved, if this is different from your preference, it may be due to current file availability.
2025-10-17T03:00:38 prefetch.3.0.3:  Downloading via HTTPS...
2025-10-17T03:01:04 prefetch.3.0.3:  HTTPS download succeed
2025-10-17T03:01:04 prefetch.3.0.3:  'SRR35790159' is valid
2025-10-17T03:01:04 prefetch.3.0.3: 1) 'SRR35790159' was downloaded successfully
2025-10-17T03:01:04 prefetch.3.0.3: 'SRR35790159' has 0 unresolved dependencies
```

``` bash         
jayz@localhost:~/yankun/data$ ls
SRR35790159
jayz@localhost:~/yankun/data$ fasterq-dump SRR35790159
spots read      : 2,320,503
reads read      : 4,641,006
reads written   : 4,641,006
jayz@localhost:~/yankun/data$ fasterq-dump SRR35790159 --split-files -O fastq_files
spots read      : 2,320,503
reads read      : 4,641,006
reads written   : 4,641,006
jayz@localhost:~/yankun/data$ ls
SRR35790159  SRR35790159_1.fastq  SRR35790159_2.fastq  fastq_files
```

``` bash          
jayz@localhost:~/yankun/data$ fastqc SRR35790159_1.fastq  SRR35790159_2.fastq
null
null
Started analysis of SRR35790159_1.fastq
Approx 5% complete for SRR35790159_1.fastq
Approx 10% complete for SRR35790159_1.fastq
Approx 15% complete for SRR35790159_1.fastq
Approx 20% complete for SRR35790159_1.fastq
Approx 25% complete for SRR35790159_1.fastq
Approx 30% complete for SRR35790159_1.fastq
Approx 35% complete for SRR35790159_1.fastq
Approx 40% complete for SRR35790159_1.fastq
Approx 45% complete for SRR35790159_1.fastq
Approx 50% complete for SRR35790159_1.fastq
Approx 55% complete for SRR35790159_1.fastq
Approx 60% complete for SRR35790159_1.fastq
Approx 65% complete for SRR35790159_1.fastq
Approx 70% complete for SRR35790159_1.fastq
Approx 75% complete for SRR35790159_1.fastq
Approx 80% complete for SRR35790159_1.fastq
Approx 85% complete for SRR35790159_1.fastq
Approx 90% complete for SRR35790159_1.fastq
Approx 95% complete for SRR35790159_1.fastq
Analysis complete for SRR35790159_1.fastq
Started analysis of SRR35790159_2.fastq
Approx 5% complete for SRR35790159_2.fastq
Approx 10% complete for SRR35790159_2.fastq
Approx 15% complete for SRR35790159_2.fastq
Approx 20% complete for SRR35790159_2.fastq
Approx 25% complete for SRR35790159_2.fastq
Approx 30% complete for SRR35790159_2.fastq
Approx 35% complete for SRR35790159_2.fastq
Approx 40% complete for SRR35790159_2.fastq
Approx 45% complete for SRR35790159_2.fastq
Approx 50% complete for SRR35790159_2.fastq
Approx 55% complete for SRR35790159_2.fastq
Approx 60% complete for SRR35790159_2.fastq
Approx 65% complete for SRR35790159_2.fastq
Approx 70% complete for SRR35790159_2.fastq
Approx 75% complete for SRR35790159_2.fastq
Approx 80% complete for SRR35790159_2.fastq
Approx 85% complete for SRR35790159_2.fastq
Approx 90% complete for SRR35790159_2.fastq
Approx 95% complete for SRR35790159_2.fastq
Analysis complete for SRR35790159_2.fastq
```

![](images/å±å¹•æˆªå›¾%202025-10-17%20111119.png)

![](images/å±å¹•æˆªå›¾%202025-10-17%20111523.png)

![](images/å±å¹•æˆªå›¾%202025-10-17%20111528.png)

![](images/å±å¹•æˆªå›¾%202025-10-17%20111534.png)

![](images/å±å¹•æˆªå›¾%202025-10-17%20111541.png)

çœ‹çœ‹ç¬¬äºŒä¸ªfatsqæ–‡ä»¶

![](images/å±å¹•æˆªå›¾%202025-10-17%20112317.png)

### ğŸ”¬ FastQC æ¨¡å—è§£é‡Šä¸åˆ†æ

| æ¨¡å— | å«ä¹‰ | æ ‡çº¢çš„å¯èƒ½åŸå›  | æ˜¯å¦å»ºè®®ä½¿ç”¨ `fastp` |
|------------------|------------------|------------------|------------------|
| **Per Sequence Content** | æ£€æŸ¥æ¯æ¡ read ä¸­å„ä½ç½®çš„ç¢±åŸºç»„æˆæ˜¯å¦ä¸€è‡´ | AMPLICON æµ‹åºå¸¸è§ï¼Œå› å¼•ç‰©æˆ–æ‰©å¢åå¥½å¯¼è‡´å‰å‡ ä½ç¢±åŸºç»„æˆåç¦» | âœ… æ˜¯ï¼Œ`fastp` å¯å‰ªåˆ‡å‰ç«¯åå·®åŒºåŸŸ |
| **Per GC Content** | æ£€æŸ¥ reads çš„ GC å«é‡åˆ†å¸ƒæ˜¯å¦ç¬¦åˆæ­£æ€åˆ†å¸ƒ | ç—…æ¯’åŸºå› ç»„ GC å«é‡æœ¬èº«åä½æˆ–æ ·æœ¬æ··æ‚ | âœ… æ˜¯ï¼Œ`fastp` å¯å»é™¤å¼‚å¸¸ readsï¼Œæ”¹å–„åˆ†å¸ƒ |
| **Sequence Duplication Levels** | æ£€æŸ¥é‡å¤ reads çš„æ¯”ä¾‹ | AMPLICON æµ‹åºä¸­ PCR æ‰©å¢ä¼šå¯¼è‡´é«˜é‡å¤ | âœ… æ˜¯ï¼Œ`fastp` å¯å»é™¤å®Œå…¨é‡å¤ reads |
| **Overrepresented Sequences** | æ£€æŸ¥æ˜¯å¦å­˜åœ¨é¢‘ç‡å¼‚å¸¸é«˜çš„åºåˆ—ï¼ˆå¦‚æ¥å¤´ã€å¼•ç‰©ï¼‰ | æ¥å¤´æ±¡æŸ“ã€å¼•ç‰©æ®‹ç•™æˆ–æ‰©å¢ä¼ªå½± | âœ… æ˜¯ï¼Œ`fastp` å¯è‡ªåŠ¨è¯†åˆ«å¹¶å»é™¤æ¥å¤´åºåˆ— |

### âœ… æ˜¯å¦æœ‰å¿…è¦ä½¿ç”¨ `fastp`ï¼Ÿ

**éå¸¸æœ‰å¿…è¦ã€‚**

å°½ç®¡ AMPLICON æµ‹åºæœ¬èº«ä¼šå¯¼è‡´æŸäº› FastQC æ¨¡å—åç¦»â€œç†æƒ³çŠ¶æ€â€ï¼Œä½†ï¼š

-   **æ¥å¤´æ±¡æŸ“** å’Œ **é‡å¤ reads** ä¼šå½±å“æ¯”å¯¹æ•ˆç‡å’Œå˜å¼‚æ£€æµ‹å‡†ç¡®æ€§ï¼›

-   **å‰ç«¯ç¢±åŸºåå·®** ä¼šå¹²æ‰°æŸäº›ä¸‹æ¸¸åˆ†æï¼ˆå¦‚å˜å¼‚å®šä½ï¼‰ï¼›

-   `fastp å¯è‡ªåŠ¨å¤„ç†è¿™äº›é—®é¢˜ï¼Œå¹¶ç”Ÿæˆæ–°çš„è´¨æ§æŠ¥å‘Šï¼Œå¸®åŠ©ä½ åˆ¤æ–­æ¸…æ´—æ•ˆæœã€‚`

### ğŸ§ª æ¨è `fastp` å‘½ä»¤ï¼ˆåŒç«¯æ•°æ®ï¼‰

``` bash           
fastp \
  -i SRR35790159_1.fastq \
  -I SRR35790159_2.fastq \
  -o SRR35790159_trimmed_1.fastq \
  -O SRR35790159_trimmed_2.fastq \
  --detect_adapter_for_pe \
  --trim_poly_g \
  --cut_front \
  --cut_tail \
  --cut_window_size 4 \
  --cut_mean_quality 20 \
  --length_required 50 \
  --thread 8 \
  --html SRR35790159_fastp.html \
  --json SRR35790159_fastp.json
```

``` bash          
jayz@localhost:~/yankun/data$ fastp \
  -i SRR35790159_1.fastq \
  -I SRR35790159_2.fastq \
  -o SRR35790159_trimmed_1.fastq \
  -O SRR35790159_trimmed_2.fastq \
  --detect_adapter_for_pe \
  --trim_poly_g \
  --cut_front \
  --cut_tail \
  --cut_window_size 4 \
  --cut_mean_quality 20 \
  --length_required 50 \
  --thread 8 \
  --html SRR35790159_fastp.html \
  --json SRR35790159_fastp.json
Detecting adapter sequence for read1...
>I7_Nextera_Transposase_1 | >Trans2_rc | >I7_Nextera_Transposase_1 | >Trans2_rc
CTGTCTCTTATACACATCTCCGAGCCCACGAGAC

Detecting adapter sequence for read2...
>I5_Nextera_Transposase_1 | >Trans1_rc | >I5_Nextera_Transposase_1 | >Trans1_rc
CTGTCTCTTATACACATCTGACGCTGCCGACGA

Read1 before filtering:
total reads: 2320503
total bases: 232050300
Q20 bases: 219390368(94.5443%)
Q30 bases: 212369986(91.5189%)

Read2 before filtering:
total reads: 2320503
total bases: 232050300
Q20 bases: 220444754(94.9987%)
Q30 bases: 215945831(93.0599%)

Read1 after filtering:
total reads: 2198482
total bases: 215526175
Q20 bases: 212304242(98.5051%)
Q30 bases: 205663485(95.4239%)

Read2 after filtering:
total reads: 2198482
total bases: 215591822
Q20 bases: 213302358(98.9381%)
Q30 bases: 209004462(96.9445%)

Filtering result:
reads passed filter: 4396964
reads failed due to low quality: 660
reads failed due to too many N: 356
reads failed due to too short: 243026
reads with adapter trimmed: 535660
bases trimmed due to adapters: 12174695

Duplication rate: 70.2497%

Insert size peak (evaluated by paired-end reads): 148

JSON report: SRR35790159_fastp.json
HTML report: SRR35790159_fastp.html

fastp -i SRR35790159_1.fastq -I SRR35790159_2.fastq -o SRR35790159_trimmed_1.fastq -O SRR35790159_trimmed_2.fastq --detect_adapter_for_pe --trim_poly_g --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --length_required 50 --thread 8 --html SRR35790159_fastp.html --json SRR35790159_fastp.json
```

![](images/å±å¹•æˆªå›¾%202025-10-17%20113314.png)

ä¹‹åfastqcæŸ¥çœ‹ä¸€ä¸‹

``` bash           
jayz@localhost:~/yankun/data$ fastqc SRR35790159_trimmed_1.fastq SRR35790159_trimmed_2.fastq
null
null
Started analysis of SRR35790159_trimmed_1.fastq
Approx 5% complete for SRR35790159_trimmed_1.fastq
Approx 10% complete for SRR35790159_trimmed_1.fastq
Approx 15% complete for SRR35790159_trimmed_1.fastq
Approx 20% complete for SRR35790159_trimmed_1.fastq
Approx 25% complete for SRR35790159_trimmed_1.fastq
Approx 30% complete for SRR35790159_trimmed_1.fastq
Approx 35% complete for SRR35790159_trimmed_1.fastq
Approx 40% complete for SRR35790159_trimmed_1.fastq
Approx 45% complete for SRR35790159_trimmed_1.fastq
Approx 50% complete for SRR35790159_trimmed_1.fastq
Approx 55% complete for SRR35790159_trimmed_1.fastq
Approx 60% complete for SRR35790159_trimmed_1.fastq
Approx 65% complete for SRR35790159_trimmed_1.fastq
Approx 70% complete for SRR35790159_trimmed_1.fastq
Approx 75% complete for SRR35790159_trimmed_1.fastq
Approx 80% complete for SRR35790159_trimmed_1.fastq
Approx 85% complete for SRR35790159_trimmed_1.fastq
Approx 90% complete for SRR35790159_trimmed_1.fastq
Approx 95% complete for SRR35790159_trimmed_1.fastq
Analysis complete for SRR35790159_trimmed_1.fastq
Started analysis of SRR35790159_trimmed_2.fastq
Approx 5% complete for SRR35790159_trimmed_2.fastq
Approx 10% complete for SRR35790159_trimmed_2.fastq
Approx 15% complete for SRR35790159_trimmed_2.fastq
Approx 20% complete for SRR35790159_trimmed_2.fastq
Approx 25% complete for SRR35790159_trimmed_2.fastq
Approx 30% complete for SRR35790159_trimmed_2.fastq
Approx 35% complete for SRR35790159_trimmed_2.fastq
Approx 40% complete for SRR35790159_trimmed_2.fastq
Approx 45% complete for SRR35790159_trimmed_2.fastq
Approx 50% complete for SRR35790159_trimmed_2.fastq
Approx 55% complete for SRR35790159_trimmed_2.fastq
Approx 60% complete for SRR35790159_trimmed_2.fastq
Approx 65% complete for SRR35790159_trimmed_2.fastq
Approx 70% complete for SRR35790159_trimmed_2.fastq
Approx 75% complete for SRR35790159_trimmed_2.fastq
Approx 80% complete for SRR35790159_trimmed_2.fastq
Approx 85% complete for SRR35790159_trimmed_2.fastq
Approx 90% complete for SRR35790159_trimmed_2.fastq
Approx 95% complete for SRR35790159_trimmed_2.fastq
Analysis complete for SRR35790159_trimmed_2.fastq
jayz@localhost:~/yankun/data$ ls
SRR35790159                SRR35790159_2_fastqc.zip           SRR35790159_trimmed_2.fastq
SRR35790159_1.fastq        SRR35790159_fastp.html             SRR35790159_trimmed_2_fastqc.html
SRR35790159_1_fastqc.html  SRR35790159_fastp.json             SRR35790159_trimmed_2_fastqc.zip
SRR35790159_1_fastqc.zip   SRR35790159_trimmed_1.fastq        fastq_files
SRR35790159_2.fastq        SRR35790159_trimmed_1_fastqc.html
SRR35790159_2_fastqc.html  SRR35790159_trimmed_1_fastqc.zip
```

### ğŸ§¬ æ¨èå‚è€ƒåŸºå› ç»„ï¼šSARS-CoV-2 Wuhan-Hu-1

-   **NCBI RefSeq ID**ï¼šNC_045512.2

-   **æè¿°**ï¼šè¿™æ˜¯æœ€æ—©å‘å¸ƒçš„ SARS-CoV-2 å®Œæ•´å‚è€ƒåŸºå› ç»„ï¼ˆWuhan-Hu-1 æ ªï¼‰

-   **é•¿åº¦**ï¼š29,903 bp

-   **ç”¨é€”**ï¼šå¹¿æ³›ç”¨äºå˜å¼‚æ£€æµ‹ã€æ¯”å¯¹ã€æ³¨é‡Šç­‰åˆ†æä»»åŠ¡

### ğŸ“¥ ä¸‹è½½å‚è€ƒåŸºå› ç»„å¹¶æ”¾å…¥ `reference/` æ–‡ä»¶å¤¹

ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ Linux ç»ˆç«¯ä¸­å®Œæˆä¸‹è½½ï¼š

``` bash          
mkdir -p reference
cd reference

# ä¸‹è½½å‚è€ƒåŸºå› ç»„ FASTA æ–‡ä»¶
wget -O SARS-CoV-2_reference.fasta "https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/858/895/GCF_009858895.2_ASM985889v3/GCF_009858895.2_ASM985889v3_genomic.fna.gz"

# è§£å‹
gunzip GCF_009858895.2_ASM985889v3_genomic.fna.gz

# é‡å‘½åä¸ºç»Ÿä¸€æ ¼å¼
mv GCF_009858895.2_ASM985889v3_genomic.fna SARS-CoV-2_reference.fasta
```

``` bash          
jayz@localhost:~/yankun/data/reference$ wget --no-proxy -O SARS-CoV-2_reference.fasta.gz "https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/858/895/GCF_009858895.2_ASM985889v3/GCF_009858895.2_ASM985889v3_genomic.fna.gz"
--2025-10-17 11:42:09--  https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/858/895/GCF_009858895.2_ASM985889v3/GCF_009858895.2_ASM985889v3_genomic.fna.gz
Resolving ftp.ncbi.nlm.nih.gov (ftp.ncbi.nlm.nih.gov)... 130.14.250.11, 130.14.250.12, 130.14.250.31, ...
Connecting to ftp.ncbi.nlm.nih.gov (ftp.ncbi.nlm.nih.gov)|130.14.250.11|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 9591 (9.4K) [application/x-gzip]
Saving to: â€˜SARS-CoV-2_reference.fasta.gzâ€™

SARS-CoV-2_reference.fasta.gz 100%[=================================================>]   9.37K  --.-KB/s    in 0s

2025-10-17 11:42:11 (193 MB/s) - â€˜SARS-CoV-2_reference.fasta.gzâ€™ saved [9591/9591]

jayz@localhost:~/yankun/data/reference$ ls
SARS-CoV-2_reference.fasta  SARS-CoV-2_reference.fasta.gz
jayz@localhost:~/yankun/data/reference$
```

### ä¸‹ä¸€æ­¥å»ºè®®

1.  **æ„å»ºç´¢å¼•ï¼ˆä»¥ bwa ä¸ºä¾‹ï¼‰**ï¼š

    ``` bash           
    bwa index reference/SARS-CoV-2_reference.fasta
    ```

``` bash           
jayz@localhost:~/yankun/data$ bwa index reference/SARS-CoV-2_reference.fasta
[bwa_index] Pack FASTA... 0.00 sec
[bwa_index] Construct BWT for the packed sequence...
[bwa_index] 0.00 seconds elapse.
[bwa_index] Update BWT... 0.00 sec
[bwa_index] Pack forward-only FASTA... 0.00 sec
[bwa_index] Construct SA from BWT and Occ... 0.00 sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa index reference/SARS-CoV-2_reference.fasta
[main] Real time: 0.076 sec; CPU: 0.002 sec
```

-   **æ¯”å¯¹ reads åˆ°å‚è€ƒåŸºå› ç»„**ï¼š

   

    ```bash         
    bwa mem reference/SARS-CoV-2_reference.fasta \
      SRR35790159_trimmed_1.fastq SRR35790159_trimmed_2.fastq \
      > SRR35790159_aligned.sam
    ```

   ``` bash           
    jayz@localhost:~/yankun/data$ bwa mem reference/SARS-CoV-2_reference.fasta \
      SRR35790159_trimmed_1.fastq SRR35790159_trimmed_2.fastq \
      > SRR35790159_aligned.sam
    [M::bwa_idx_load_from_disk] read 0 ALT contigs
    [M::process] read 101986 sequences (10000008 bp)...
    [M::process] read 101942 sequences (10000099 bp)...
    [M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (5, 49958, 0, 8)
    [M::mem_pestat] skip orientation FF as there are not enough pairs
    [M::mem_pestat] analyzing insert size distribution for orientation FR...
    [M::mem_pestat] (25, 50, 75) percentile: (129, 174, 230)
    [M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 432)
    [M::mem_pestat] mean and std.dev: (183.42, 72.11)
    [M::mem_pestat] low and high boundaries for proper pairs: (1, 533)
    [M::mem_pestat] skip orientation RF as there are not enough pairs
    [M::mem_pestat] skip orientation RR as there are not enough pairs
    [M::mem_process_seqs] Processed 101986 reads in 1.489 CPU sec, 1.417 real sec
    [M::process] read 101990 sequences (10000097 bp)...
    ...
    ...
    [M::mem_pestat] skip orientation FF as there are not enough pairs
    [M::mem_pestat] analyzing insert size distribution for orientation FR...
    [M::mem_pestat] (25, 50, 75) percentile: (129, 174, 230)
    [M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 432)
    [M::mem_pestat] mean and std.dev: (183.93, 72.18)
    [M::mem_pestat] low and high boundaries for proper pairs: (1, 533)
    [M::mem_pestat] skip orientation RF as there are not enough pairs
    [M::mem_pestat] skip orientation RR as there are not enough pairs
    [M::mem_process_seqs] Processed 101944 reads in 1.532 CPU sec, 1.488 real sec
    [M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (1, 5568, 0, 0)
    [M::mem_pestat] skip orientation FF as there are not enough pairs
    [M::mem_pestat] analyzing insert size distribution for orientation FR...
    [M::mem_pestat] (25, 50, 75) percentile: (131, 176, 230)
    [M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 428)
    [M::mem_pestat] mean and std.dev: (184.31, 71.90)
    [M::mem_pestat] low and high boundaries for proper pairs: (1, 527)
    [M::mem_pestat] skip orientation RF as there are not enough pairs
    [M::mem_pestat] skip orientation RR as there are not enough pairs
    [M::mem_process_seqs] Processed 11366 reads in 0.211 CPU sec, 0.176 real sec
    [main] Version: 0.7.17-r1188
    [main] CMD: bwa mem reference/SARS-CoV-2_reference.fasta SRR35790159_trimmed_1.fastq SRR35790159_trimmed_2.fastq
    [main] Real time: 62.444 sec; CPU: 66.297 sec
    ```

    ``` bash          
    jayz@localhost:~/yankun/data$ ls
    SRR35790159                SRR35790159_2_fastqc.zip           SRR35790159_trimmed_1_fastqc.zip   test.sam
    SRR35790159_1.fastq        SRR35790159_aligned.sam            SRR35790159_trimmed_2.fastq        test_1.fastq
    SRR35790159_1_fastqc.html  SRR35790159_fastp.html             SRR35790159_trimmed_2_fastqc.html  test_2.fastq
    SRR35790159_1_fastqc.zip   SRR35790159_fastp.json             SRR35790159_trimmed_2_fastqc.zip   test_minimap.sam
    SRR35790159_2.fastq        SRR35790159_trimmed_1.fastq        fastq_files
    SRR35790159_2_fastqc.html  SRR35790159_trimmed_1_fastqc.html  reference
    ```

-   **è½¬æ¢ä¸º BAM å¹¶æ’åº**ï¼š

    ``` bash           
    samtools view -Sb SRR35790159_aligned.sam | samtools sort -o SRR35790159_sorted.bam
    samtools index SRR35790159_sorted.bam
    ```

   ``` bash         
    jayz@localhost:~/yankun/data$ samtools view -Sb SRR35790159_aligned.sam | samtools sort -o SRR35790159_sorted.bam
    [bam_sort_core] merging from 1 files and 1 in-memory blocks...
    jayz@localhost:~/yankun/data$ samtools index SRR35790159_sorted.bam
    ```

-   **è¦†ç›–åº¦åˆ†æ**ï¼š

    ``` bash           
    samtools depth SRR35790159_sorted.bam > SRR35790159_coverage.txt 
    ```

    ``` bash          
    jayz@localhost:~/yankun/data$ samtools view -Sb SRR35790159_aligned.sam | samtools sort -o SRR35790159_sorted.bam
    [bam_sort_core] merging from 1 files and 1 in-memory blocks...
    jayz@localhost:~/yankun/data$ samtools index SRR35790159_sorted.bam
    jayz@localhost:~/yankun/data$ samtools depth SRR35790159_sorted.bam > SRR35790159_coverage.txt
    jayz@localhost:~/yankun/data$ head SRR35790159_coverage.txt -n 10
    NC_045512.2     47      1
    NC_045512.2     48      5
    NC_045512.2     49      9
    NC_045512.2     50      9
    NC_045512.2     51      9
    NC_045512.2     52      9
    NC_045512.2     53      11
    NC_045512.2     54      15
    NC_045512.2     55      15
    NC_045512.2     56      30
    ```

    è¡¨ç¤ºå‚è€ƒåºåˆ— `NC_045512.2` çš„ç¬¬ 47 ä¸ªç¢±åŸºä½ç½®è¢«è¦†ç›–äº† 1 æ¬¡

### ğŸ” å¿«é€Ÿåˆ†æ

-   ä»ç¬¬ 47 ä½å¼€å§‹ï¼Œè¦†ç›–åº¦é€æ¸ä¸Šå‡ï¼Œè¯´æ˜æµ‹åº reads åœ¨è¿™ä¸ªåŒºåŸŸå¼€å§‹æœ‰æ¯”å¯¹ã€‚

-   ç¬¬ 56 ä½è¦†ç›–åº¦è¾¾åˆ° 30ï¼Œè¯´æ˜è¯¥åŒºåŸŸå¯èƒ½æ˜¯ reads å¯Œé›†åŒºåŸŸæˆ– PCR å¯Œé›†åŒºåŸŸã€‚

æŠŠæ–‡ä»¶å¯¼å…¥windowså¯è§†åŒ–ï¼Œä¸æƒ³åœ¨linuxåšï¼Œå› ä¸ºä¸‹åŒ…å¤ªæ…¢äº†

```{python}
import pandas as pd
import matplotlib.pyplot as plt

df = pd.read_csv(r"E:\acode\wsl\data4\SRR35790159_coverage.txt", sep="\t", header=None, names=["ref", "pos", "depth"])
plt.figure(figsize=(12, 4))
plt.plot(df["pos"], df["depth"], color="steelblue")
plt.xlabel("Position on reference")
plt.ylabel("Coverage depth")
plt.title("Coverage profile of SRR35790159")
plt.tight_layout()
plt.show()
```

![](plot-33.png)

#### âœ… æ€»è¦†ç›–ä½ç½®æ•°ï¼ˆå³æœ‰ reads è¦†ç›–çš„ä½ç½®æ•°ï¼‰

``` bash          
wc -l SRR35790159_coverage.txt 
```
``` bash          
jayz@localhost:~/yankun/data$ wc -l SRR35790159_coverage.txt
26444 SRR35790159_coverage.txt
```

#### âœ… å¹³å‡è¦†ç›–æ·±åº¦

``` bash       
awk '{sum+=$3} END {print "Average depth:", sum/NR}' SRR35790159_coverage.txt 
```

``` bash         
jayz@localhost:~/yankun/data$ awk '{sum+=$3} END {print "Average depth:", sum/NR}' SRR35790159_coverage.txt
Average depth: 15891
```

#### âœ… æœ€å¤§è¦†ç›–æ·±åº¦

``` bash          
awk 'max<$3{max=$3} END{print "Max depth:", max}' SRR35790159_coverage.txt 
```

``` bash          
jayz@localhost:~/yankun/data$ awk 'max<$3{max=$3} END{print "Max depth:", max}' SRR35790159_coverage.txt
Max depth: 419399
```

#### âœ… æœ€å°è¦†ç›–æ·±åº¦ï¼ˆéé›¶ï¼‰

``` bash           
awk 'min==0 || ($3<min && $3>0){min=$3} END{print "Min depth:", min}' SRR35790159_coverage.txt 
```

``` bash           
jayz@localhost:~/yankun/data$ awk 'min==0 || ($3<min && $3>0){min=$3} END{print "Min depth:", min}' SRR35790159_coverage.txt
Min depth: 1
```

### âœ… ç­›é€‰å‡ºè¦†ç›–åº¦ \>30Ã— çš„åŒºåŸŸæ€»æ•°

``` bash          
awk '$3 > 30 {count++} END {print "Positions with depth >30x:", count}' SRR35790159_coverage.txt 
```

``` bash          
jayz@localhost:~/yankun/data$ awk '$3 > 30 {count++} END {print "Positions with depth >30x:", count}' SRR35790159_coverage.txt
Positions with depth >30x: 22451
```

å¦‚æœæƒ³è®¡ç®—æ¯”ä¾‹ï¼ˆè¦†ç›–åº¦ \>30Ã— çš„åŒºåŸŸå æ€»å‚è€ƒé•¿åº¦ï¼‰ï¼š

``` bash          
total=$(wc -l < SRR35790159_coverage.txt)
high=$(awk '$3 > 30 {count++} END {print count}' SRR35790159_coverage.txt)
echo "Proportion >30x: " $(echo "$high/$total" | bc -l)
```

``` bash           
jayz@localhost:~/yankun/data$ total=$(wc -l < SRR35790159_coverage.txt)
high=$(awk '$3 > 30 {count++} END {print count}' SRR35790159_coverage.txt)
echo "Proportion >30x: " $(echo "$high/$total" | bc -l)
Proportion >30x:  .84900166389351081530
```

å‘ç°çº¦ 84.9% çš„å‚è€ƒåŒºåŸŸè¦†ç›–åº¦é«˜äº 30Ã—

## SNPå˜å¼‚åˆ†æ

## ğŸ§± ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆé«˜è¦†ç›–åŒºåŸŸ BED æ–‡ä»¶ï¼ˆ\>30Ã—ï¼‰

``` bash          
awk '$3 > 30 {print $1"\t"$2-1"\t"$2}' SRR35790159_coverage.txt > high_coverage.bed 
```

è¯´æ˜ï¼š

-   BED æ ¼å¼æ˜¯ 0-based å·¦é—­å³å¼€ï¼Œæ‰€ä»¥ `start = pos - 1`, `end = pos`

-   è¾“å‡ºæ ¼å¼ä¸ºï¼š`<ref> <start> <end>`

##  ç¬¬äºŒæ­¥ï¼šSNP Calling æµç¨‹ï¼ˆæ¨èç”¨ bcftoolsï¼‰

ï¼š

-   æ’åºåçš„ BAM æ–‡ä»¶ï¼š`SRR35790159_sorted.bam`

-   ç´¢å¼•æ–‡ä»¶ï¼š`SRR35790159_sorted.bam.bai`

-   å‚è€ƒåºåˆ—ï¼š`SARS-CoV-2_reference.fasta`ï¼ˆå·²ç´¢å¼•ï¼‰

### âœ… 1. åˆ›å»º mpileupï¼ˆé™åˆ¶åœ¨é«˜è¦†ç›–åŒºåŸŸï¼‰

``` bash          
bcftools mpileup --threads 8 -f reference/SARS-CoV-2_reference.fasta SRR35790159_sorted.bam -Oz -o raw.vcf.gz

#threads 8 ,8æ ¸å¿ƒåŠ å¿«é€Ÿåº¦
```

### âœ… 2. SNP Calling

``` bash        
bcftools call -m --ploidy 1 -Oz -o call.vcf.gz raw.vcf.gz
```

## ğŸ§­ ç´¢å¼• VCF æ–‡ä»¶

ä½¿ç”¨ `tabix` ä¸ºå‹ç¼©çš„ VCF æ–‡ä»¶åˆ›å»ºç´¢å¼•ï¼š



``` bash        
tabix -p vcf call.vcf.gz 
```

è¿™ä¼šç”Ÿæˆ `call.vcf.gz.tbi` ç´¢å¼•æ–‡ä»¶ï¼Œä¾›åç»­å¿«é€ŸæŸ¥è¯¢å’Œå¯è§†åŒ–ä½¿ç”¨ã€‚

## ğŸ“Š å¯è§†åŒ– SNP åˆ†å¸ƒï¼ˆPythonï¼‰

ä½ å¯ä»¥ç”¨ `pysam` æˆ– `cyvcf2` è¯»å– VCF æ–‡ä»¶å¹¶ç”¨ `matplotlib` å¯è§†åŒ– SNP åˆ†å¸ƒï¼š

### âœ… ç¤ºä¾‹ï¼šç»˜åˆ¶ SNP åœ¨å‚è€ƒåºåˆ—ä¸Šçš„ä½ç½®åˆ†å¸ƒ



```{python}         
import gzip
import matplotlib.pyplot as plt

positions = []
with gzip.open(r"E:\acode\wsl\data4\call.vcf.gz", "rt") as f:
    for line in f:
        if line.startswith("#"):
            continue
        fields = line.strip().split("\t")
        pos = int(fields[1])
        positions.append(pos)

plt.figure(figsize=(12, 4))
plt.hist(positions, bins=100, color="darkorange", edgecolor="black")
plt.xlabel("Position on reference genome")
plt.ylabel("SNP count")
plt.title("SNP Distribution Across Reference")
plt.tight_layout()
plt.show()
```

### âœ… ç¤ºä¾‹ï¼šç»Ÿè®¡ SNP æ•°é‡å’Œè´¨é‡åˆ†å¸ƒ



``` {python}        
import gzip
import matplotlib.pyplot as plt

qual_scores = []
with gzip.open(r"E:\acode\wsl\data4\call.vcf.gz", "rt") as f:
    for line in f:
        if line.startswith("#"):
            continue
        fields = line.strip().split("\t")
        qual_field = fields[5]
        if qual_field != ".":
            try:
                qual = float(qual_field)
                qual_scores.append(qual)
            except ValueError:
                continue  # å¿½ç•¥æ— æ³•è§£æçš„è´¨é‡å€¼

plt.figure(figsize=(8, 4))
plt.hist(qual_scores, bins=50, color="steelblue", edgecolor="black")
plt.xlabel("SNP Quality Score")
plt.ylabel("Count")
plt.title("SNP Quality Distribution")
plt.tight_layout()
plt.show()

```



```bash
jayz@localhost:~/yankun$ tree
â””â”€â”€ data
    â”œâ”€â”€ SRR35790159
    â”‚Â Â  â””â”€â”€ SRR35790159.sra
    â”œâ”€â”€ SRR35790159_1.fastq
    â”œâ”€â”€ SRR35790159_1_fastqc.html
    â”œâ”€â”€ SRR35790159_1_fastqc.zip
    â”œâ”€â”€ SRR35790159_2.fastq
    â”œâ”€â”€ SRR35790159_2_fastqc.html
    â”œâ”€â”€ SRR35790159_2_fastqc.zip
    â”œâ”€â”€ SRR35790159_aligned.sam
    â”œâ”€â”€ SRR35790159_coverage.txt
    â”œâ”€â”€ SRR35790159_fastp.html
    â”œâ”€â”€ SRR35790159_fastp.json
    â”œâ”€â”€ SRR35790159_raw.bcf
    â”œâ”€â”€ SRR35790159_sorted.bam
    â”œâ”€â”€ SRR35790159_sorted.bam.bai
    â”œâ”€â”€ SRR35790159_trimmed_1.fastq
    â”œâ”€â”€ SRR35790159_trimmed_1_fastqc.html
    â”œâ”€â”€ SRR35790159_trimmed_1_fastqc.zip
    â”œâ”€â”€ SRR35790159_trimmed_2.fastq
    â”œâ”€â”€ SRR35790159_trimmed_2_fastqc.html
    â”œâ”€â”€ SRR35790159_trimmed_2_fastqc.zip
    â”œâ”€â”€ call.vcf.gz
    â”œâ”€â”€ call.vcf.gz.tbi
    â”œâ”€â”€ fastq_files
    â”‚Â Â  â”œâ”€â”€ SRR35790159_1.fastq
    â”‚Â Â  â””â”€â”€ SRR35790159_2.fastq
    â”œâ”€â”€ high_coverage.bed
    â”œâ”€â”€ raw.vcf.gz
    â”œâ”€â”€ reference
    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta
    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.amb
    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.ann
    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.bwt
    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.fai
    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.gz
    â”‚Â Â  â”œâ”€â”€ SARS-CoV-2_reference.fasta.pac
    â”‚Â Â  â””â”€â”€ SARS-CoV-2_reference.fasta.sa
    â”œâ”€â”€ test.sam
    â”œâ”€â”€ test_1.fastq
    â”œâ”€â”€ test_2.fastq
    â””â”€â”€ test_minimap.sam

5 directories, 38 files

```